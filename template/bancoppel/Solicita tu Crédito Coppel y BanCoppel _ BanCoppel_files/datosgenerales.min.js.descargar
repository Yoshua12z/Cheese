$(document).ready(function(){localStorage.num_etapasolicitud=$("#num_etapa_solicitud").val()||"";var scriptElement=document.createElement("script");scriptElement.src=window.UrlCaptcha;scriptElement.async=true;document.head.appendChild(scriptElement);removeStorageTimer();function executeCaptcha(){grecaptcha.execute("6LdaRd4ZAAAAAMNEDzE0hNJ9RoTo98vDf2hUhAxP",{action:"submit"}).then(function(token){document.getElementById("captchatoken").value=token;sendData()})}function sendData(){if(SolicitudCreditoValidations.validateForm($("#mainForm"))){var formActionUrl=window.urlDatosCrediticios;SolicitudCreditoTagManager.procesandoGeneral();var saveValuesJSON={isFirstSave:true,callback:function(_response){const formType=_response.data[0].flag_canal_sic;localStorage.formType=formType;Loading.loadingFinish();SolicitudCreditoValidations.exitCallbackFlag=0;linkRedirect(formActionUrl)},errorCallback:function(response){if(response&&response.code){switch(response.code){case"FAILED_CLIENTE_COPPEL":SolicitudCreditoValidations.exitCallbackFlag=0;linkRedirect(window.tpErrorClienteCoppel);break;case"FAILED_HOMONIMIA":SolicitudCreditoValidations.exitCallbackFlag=0;linkRedirect(window.tpErrorSolicitudProceso);break;case"FAILED_NOMBRE_ABREVIADO":Loading.hide();var $inputName=$("input#name");SolicitudCreditoValidations.setInputError($inputName.get(0),SolicitudCreditoValidations.defaultErrorMessages.nameAbreviationValidation);pageNameTagsError(SolicitudCreditoValidations.defaultErrorMessages.nameAbreviationValidation,$inputName.get(0));$inputName.attr("data-lockerror",1).attr("data-lastvalue",$inputName.val()).focus().focusin();break;case"FAILED_APELLIDO_PATERNO":Loading.hide();var $inputLastname=$("input#lastname");SolicitudCreditoValidations.setInputError($inputLastname.get(0),SolicitudCreditoValidations.defaultErrorMessages.surnameAbreviationValidation);pageNameTagsError(SolicitudCreditoValidations.defaultErrorMessages.surnameAbreviationValidation,$inputLastname.get(0));$inputLastname.attr("data-lockerror",1).attr("data-lastvalue",$inputLastname.val()).focus().focusin();break;case"FAILED_APELLIDO_MATERNO":Loading.hide();var $inputMiddlename=$("input#middlename");SolicitudCreditoValidations.setInputError($inputMiddlename.get(0),SolicitudCreditoValidations.defaultErrorMessages.secondSurnameAbreviationValidation);pageNameTagsError(SolicitudCreditoValidations.defaultErrorMessages.secondSurnameAbreviationValidation,$inputMiddlename.get(0));$inputMiddlename.attr("data-lockerror",1).attr("data-lastvalue",$inputMiddlename.val()).focus().focusin();break;case"EMAIL_NOVALIDO":Loading.hide();var $inputEmail=$("input#email");SolicitudCreditoValidations.setInputError($inputEmail.get(0),response.message);pageNameTagsError(response.message,$inputEmail.get(0));$inputEmail.attr("data-lockerror",1).attr("data-lastvalue",$inputEmail.val()).focus().focusin();break;case"CELULAR_NOVALIDO":Loading.hide();var $inputPhone=$("input#phone");SolicitudCreditoValidations.setInputError($inputPhone.get(0),response.message);pageNameTagsError(response.message,$inputPhone.get(0));$inputPhone.attr("data-lockerror",1).attr("data-lastvalue",$inputPhone.val()).focus().focusin();break;case"FECHA_NOVALIDO":Loading.hide();var $inputBirthYear=$("#birth_year");pageNameTagsError(response.message,$inputBirthYear.get(0));SolicitudCreditoValidations.exitCallbackFlag=0;linkRedirect(window.tpRechazada);break;case"SINPRODUCTOS":SolicitudCreditoValidations.exitCallbackFlag=0;linkRedirect(window.tpSinProducto);break;default:SolicitudCreditoValidations.exitCallbackFlag=0;linkRedirect(window.tpErrorDatosGenerales)}SolicitudCreditoValidations.submitButtonAvailability("mainForm")}else{SolicitudCreditoValidations.exitCallbackFlag=0;linkRedirect(window.tpErrorDatosGenerales)}}};saveValues(saveValuesJSON)}else{return false}}$("#mainForm").on("submit",function(e){SolicitudCreditoTagManager.datosPersonalesContinuar();e.preventDefault();confirmacionNombre()});$("#mainForm").attr("novalidate","novalidate");$("#birth_year, #birth_month, #birth_day").on("change",function(_e){birthdayRequiredValidation();if($("#birth_year").hasClass("success")&&$("#birth_month").hasClass("success")&&$("#birth_year").hasClass("success")){SolicitudCreditoTagManager.catchSuccess($("#birth_year").parent().parent().siblings("span").text().replace("*","").trim())}}).on("blur",function(){setTimeout(function(){birthdayRequiredValidation()},50)});SolicitudCreditoValidations.loadComboDates("#birth_year","#birth_month","#birth_day");$("#mainForm").find('input[data-valid], input:required:not([type="radio"]), select:required').on("blur",function(_e){var input=this;if(input.id=="phone_confirm"){}else{SolicitudCreditoValidations.validInput(input,"blur")}}).on("change",function(){var input=this;SolicitudCreditoValidations.validInput(input)});$("input,select").on("change",function(_e){if(typeof window.primera_iteracion=="undefined"){SolicitudCreditoTagManager.datosPersonalesInteraccion()}window.primera_iteracion=true});$("#name, #secondname, #lastname, #middlename, #birth_year, #birth_month, #birth_day").on("change",function(){if(cleanEmptySpaces($("#name").val())!=""&&cleanEmptySpaces($("#lastname").val())!=""){var rfc=CalcularRFC($("#name").val()||"XX",$("#secondname").val()||"XX",$("#lastname").val()||"XX",$("#middlename").val()||"XX",$("#birth_year").val()||"XXXX",$("#birth_month").val()||"XX",$("#birth_day").val()||"XX");$("#rfc").val(rfc);$("#rfc").trigger("change")}else{SolicitudCreditoValidations.clearInputStatus($("#rfc"));$("#rfc").val("")}});$("#name, #secondname, #lastname, #middlename").keyup(function(){this.value=this.value.toUpperCase()});$("#phone").on("blur",phoneMatchTrigger);$("#phone, #email, #name, #lastname, #middlename").on("change",errorLockUntilChangeEvent).on("keyup",errorLockUntilChangeEvent);$("#phone, #phone_confirm").on("keyup",function(e){if(e.key=="Backspace"){return true}const phoneNumber=$(this);const newValue=phoneFormat(phoneNumber.val());phoneNumber.val(newValue)});$("#mainForm").find("input[data-valid]").on("keypress",SolicitudCreditoValidations.validKeyPressEvents);$("#mainForm").find("input[data-valid], input:required").on("keyup",SolicitudCreditoValidations.validKeyUpEvents);$(".checkbox-terminos").is(":checked",function(){SolicitudCreditoTagManager.avisoPrivacidad()});function checkboxChange(e){var k=document.getElementsByTagName("*")?e.keyCode:e.which;if(e.type=="keydown"&&k=="13"){this.checked=!this.checked}if(this.checked){SolicitudCreditoValidations.validateForm(document.getElementById("mainForm"),{scrollToError:false})}if(e.type=="keydown"&&k=="13"){return false}}$('input[type="checkbox"]').on("change",checkboxChange).on("keydown",checkboxChange);if(!isMobile()){$('input[type="tel"]').attr("type","text")}function phoneMatchTrigger(){if(cleanEmptySpaces($("#phone_confirm").val())!=""){if($("#phone").val().length==12){SolicitudCreditoValidations.validInput($("#phone_confirm")[0])}}}SolicitudCreditoValidations.disablePasterForm("#mainForm");SolicitudCreditoValidations.currentForm="#mainForm";clearAllInputs(SolicitudCreditoValidations.currentForm);checkLead();localStorage.solicitud_credito_parametrico_resultado=null;localStorage.solicitud_credito="{}";localStorage.edad=null;localStorage.removeItem("celularConfirmado");localStorage.removeItem("recuperacionCAT");localStorage.removeItem("uuidToken");localStorage.removeItem("formType");localStorage.removeItem("autentico_buro");localStorage.removeItem("etapaCliente");$("#submitConfirmar").click(function(){var modal=document.getElementById("myModal");modal.style.display="none";executeCaptcha()});$("#submitCancel").click(function(){var modal=document.getElementById("myModal");modal.style.display="none";document.getElementById("name").focus().focusin()});$("#btn-confirmacion-regresar").click(function(){var modal=document.getElementById("myModal");modal.style.display="none"});$("#name").on("focusout",function(){namingRules()});$("#secondname").on("focusout",function(){namingRules()});$("#lastname").on("focusout",function(){namingRules()});$("#middlename").on("focusout",function(){namingRules()});setAuthTokenLocalStorage()});function errorLockUntilChangeEvent(e){var $this=$(this);var dataLockError=$this.attr("data-lockerror")||0;if(dataLockError){if(e.type=="change"||e.type=="keyup"){var lastValue=$this.attr("data-lastvalue")||"";if(lastValue!=$this.val()){$this.attr("data-lockerror",0);SolicitudCreditoValidations.validateForm($("#mainForm"))}}}}function birthdayRequiredValidation(){var birthYear=$("#birth_year").val();var birthMonth=$("#birth_month").val();var birthDay=$("#birth_day").val();var isValid=isDayAvailable(true,birthYear,birthMonth,birthDay);$("#birth_year").parent().parent().find(".errorMessage").remove();var errorMessageAux,htmlMessage;if(!isValid){errorMessageAux=SolicitudCreditoValidations.getErrorMessageByInput($("#birth_year").get(0),"required");SolicitudCreditoValidations.validInput($("#birth_year").get(0));SolicitudCreditoValidations.validInput($("#birth_month").get(0));SolicitudCreditoValidations.validInput($("#birth_day").get(0));htmlMessage='<span data-abide-error="" class="alert callout error errorMessage" style="display: block;" aria-live="assertive">'+errorMessageAux+"</span>";$("#birth_year").parent().parent().append(htmlMessage);if(birthDay==""&&birthMonth==""&&birthYear==""){pageNameTagsError(errorMessageAux,"fnd5")}}else{if(birthYear>0&&birthMonth>0&&birthDay>0){var birthValid=SolicitudCreditoValidations.validAge("#birth_year","#birth_month","#birth_day");if(!birthValid){SolicitudCreditoValidations.setInputError($("#birth_year"),false);SolicitudCreditoValidations.setInputError($("#birth_month"),false);SolicitudCreditoValidations.setInputError($("#birth_day"),false);errorMessageAux=SolicitudCreditoValidations.getErrorMessageByInput($("#birth_year").get(0),"adultAge");htmlMessage='<span data-abide-error="" class="alert callout error errorMessage" style="display: block;" aria-live="assertive">'+errorMessageAux+"</span>";$("#birth_year").parent().parent().append(htmlMessage)}}}}function isDayAvailable(value,birthYear,birthMonth,birthDay){var isValid=value;if($("#birth_year,#birth_month,#birth_day").is(":focus")){if(birthYear!=""&&birthMonth!=""&&birthDay!=""){isValid&=SolicitudCreditoValidations.validInput($("#birth_year").get(0));isValid&=SolicitudCreditoValidations.validInput($("#birth_month").get(0));isValid&=SolicitudCreditoValidations.validInput($("#birth_day").get(0));SolicitudCreditoValidations.setDayAvailable("#birth_year","#birth_month","#birth_day")}else{if(birthYear!=""||birthMonth!=""||birthDay!=""){if($("#birth_year").parent().parent().find(".errorMessage").length>0){isValid=false}}}}else{if(birthYear==""||birthMonth==""||birthDay==""){isValid=false}}return isValid}$("#linkVerMasAviso").click(function(e){e.preventDefault();$("#contenidoOcultoAvisoPrivacidad").show();$("#avisoPrivacidadVerMas").hide();SolicitudCreditoTagManager.avisoPrivacidadVerMas()});$("#avisoPrivacidadEnlace, #link-bancoppel, #condusef, #link-email").on("click",function(_e){var btnClicked=$(this)[0].id;switch(btnClicked){case"avisoPrivacidadEnlace":SolicitudCreditoTagManager.avisoPrivacidadEnlace();break;case"link-bancoppel":SolicitudCreditoTagManager.datosPersonalesLinkBanCoppel();break;case"condusef":SolicitudCreditoTagManager.datosPersonalesLinkCondusef();break;case"link-email":SolicitudCreditoTagManager.datosPersonalesLinkEmail();break}});$(document).foundation();function CalcularRFC($nombre,$segundoNombre,$apellidoPaterno,$apellidoMaterno,$year,$month,$day){var nombre=omitirAcentos(cleanEmptySpaces($nombre).toUpperCase());var segundo_nombre=omitirAcentos(cleanEmptySpaces($segundoNombre).toUpperCase());var apellidoPaterno=omitirAcentos(cleanEmptySpaces($apellidoPaterno).toUpperCase());var apellidoMaterno=omitirAcentos(cleanEmptySpaces($apellidoMaterno).toUpperCase());var rfc="";if(nombre.length>0&&apellidoPaterno.length>0){const yearBirth=cleanEmptySpaces($year);const monthBirth=cleanEmptySpaces($month);const dayBirth=cleanEmptySpaces($day);const fecha=dayBirth+"-"+monthBirth+"-"+yearBirth;apellidoPaterno=quitaArticulos(apellidoPaterno);apellidoMaterno=quitaArticulos(apellidoMaterno);rfc+=apellidoPaterno.substr(0,1);rfc+=handleLastNameVowels(apellidoPaterno);rfc+=apellidoMaterno.substr(0,1);if(apellidoMaterno.length==0){rfc+="X"+nombre.substr(0,1)}else{rfc+=handleSpecialNames(nombre,segundo_nombre)}if(esPalabraInconveniente(rfc.substring(0,4))){rfc=rfc.slice(0,3)+"X"}rfc+=fecha.substr(8,10);rfc+=fecha.substr(3,5).substr(0,2);rfc+=fecha.substr(0,2)}return rfc}function esPalabraInconveniente(palabra){var esInconveniente=false;var palabras_inconvenientes=["BUEI","BUEY","CACA","CACO","CAGA","CAGO","CAKA","CAKO","COGE","COJA","COJE","COJI","COJO","CULO","FETO","GUEY","JOTO","KACA","KACO","KAGA","KAGO","KOGE","KOJO","KAKA","KULO","MAME","MAMO","MEAR","MEAS","MEON","MION","MOCO","MULA","PEDA","PEDO","PENE","PUTA","PUTO","QULO","RATA","RUIN"];jQuery.each(palabras_inconvenientes,function(_i,val){if(palabra===val){esInconveniente=true}});return esInconveniente}function quitaArticulos(palabra){return palabra.replace("DEL ","").replace("LAS ","").replace("DE ","").replace("LA ","").replace("Y ","").replace("A ","").replace("DA ","").replace("DAS ","").replace("DER ","").replace("DI ","").replace("DIE ","").replace("DD ","").replace("EL ","").replace("LA ","").replace("LOS ","").replace("LAS ","").replace("LE ","").replace("LES ","").replace("MAC ","").replace("MC ","").replace("VAN ","").replace("VON ","").replace("Ñ","X")}function esVocal(letra){var siEsVocal=false;if(letra=="A"||letra=="E"||letra=="I"||letra=="O"||letra=="U"||letra=="a"||letra=="e"||letra=="i"||letra=="o"||letra=="u"){siEsVocal=true}return siEsVocal}function contarVocales(palabra){var contador=0;var letra;for(var j=0;j<palabra.length;j++){letra=palabra.charAt(j);if(esVocal(letra)){contador++}}return contador}function handleSpecialNames(name,middleName){if(middleName.length!=0&&(name=="MARIA"||name=="MA")){if(middleName=="JOSE"){return name.substr(0,1)}else{return middleName.substr(0,1)}}else{if(middleName.length!=0&&(name=="JOSE")){if(middleName=="MARIA"||middleName=="MA"){return name.substr(0,1)}else{return middleName.substr(0,1)}}else{return name.substr(0,1)}}}function handleLastNameVowels(lastName){var c,tempRFC;if(contarVocales(lastName)>=1){for(var i=1;i<lastName.length;i++){c=lastName.charAt(i);if(esVocal(c)){tempRFC+=c;break}}}else{tempRFC+="X"}return tempRFC}localStorage.solicitud_credito=null;localStorage.removeItem("solicitud_credito");function confirmacionNombre(){if(SolicitudCreditoValidations.validateForm($("#mainForm"))){var modal=document.getElementById("myModal");document.getElementById("nameConfirmation").value=assignValues($("#name").val(),"");document.getElementById("secondnameConfirmation").value=assignValues($("#secondname").val(),"");document.getElementById("lastnameConfirmation").value=assignValues($("#lastname").val(),"");document.getElementById("middlenameConfirmation").value=assignValues($("#middlename").val(),"");modal.style.display="block"}}function visibleSpan(control,message){$(control).parent().parent().find(".infoMessage").remove();const htmlMessage='<div style="display:flex" class="small-11 medium-8 large-12 small-centered medium-centered columns align-center infoMessage"><div class="infoIconMessage"><img src="./images/info-circle.svg" /></div><div class="infoMessageText""> '+message+"</div></div>";$(control).parent().parent().append(htmlMessage)}function namingRules(){$("#name").parent().parent().find(".infoMessage").remove();$("#secondname").parent().parent().find(".infoMessage").remove();$("#lastname").parent().parent().find(".infoMessage").remove();$("#middlename").parent().parent().find(".infoMessage").remove();var messageName="";var messageSecondName="";var messageLastName="";var messageMiddleName="";var messageNameAux="";var messageSecondNameAux="";var messageLastNameAux="";var messageMiddleNameAux="";messageNameAux=moreOneWord("#name");messageSecondNameAux=moreOneWord("#secondname");messageLastNameAux=moreOneWord("#lastname");messageMiddleNameAux=moreOneWord("#middlename");messageName=wordInSameField("#name");messageNameAux=messageName!=""?messageName:messageNameAux;messageSecondName=wordInSameField("#secondname");messageSecondNameAux=messageSecondName!=""?messageSecondName:messageSecondNameAux;messageLastName=wordInSameField("#lastname");messageLastNameAux=messageLastName!=""?messageLastName:messageLastNameAux;messageMiddleName=wordInSameField("#middlename");messageMiddleNameAux=messageMiddleName!=""?messageMiddleName:messageMiddleNameAux;messageName=wordInTwoFields("#name","#secondname");messageNameAux=messageName!=""?messageName:messageNameAux;messageSecondNameAux=messageName!=""?messageName:messageSecondNameAux;messageName=wordInTwoFields("#name","#lastname");messageNameAux=messageName!=""?messageName:messageNameAux;messageLastNameAux=messageName!=""?messageName:messageLastNameAux;messageName=wordInTwoFields("#name","#middlename");messageNameAux=messageName!=""?messageName:messageNameAux;messageMiddleNameAux=messageName!=""?messageName:messageMiddleNameAux;messageSecondName=wordInTwoFields("#secondname","#lastname");messageSecondNameAux=messageSecondName!=""?messageSecondName:messageSecondNameAux;messageLastNameAux=messageSecondName!=""?messageSecondName:messageLastNameAux;messageSecondName=wordInTwoFields("#secondname","#middlename");messageSecondNameAux=messageSecondName!=""?messageSecondName:messageSecondNameAux;messageMiddleNameAux=messageSecondName!=""?messageSecondName:messageMiddleNameAux;messageLastName=wordInTwoFields("#lastname","#middlename");messageLastNameAux=messageLastName!=""?messageLastName:messageLastNameAux;messageMiddleNameAux=messageLastName!=""?messageLastName:messageMiddleNameAux;if(messageNameAux!=""){visibleSpan("#name",messageNameAux)}if(messageSecondNameAux!=""){visibleSpan("#secondname",messageSecondNameAux)}if(messageLastNameAux!=""){visibleSpan("#lastname",messageLastNameAux)}if(messageMiddleNameAux!=""){visibleSpan("#middlename",messageMiddleNameAux)}}function moreOneWord(control){var caracter=cleanEmptySpaces($(control).val()).split(" ");if(caracter.length>1){return"Asegúrate de no capturar  nombre y apellido o dos nombres en un solo campo"}return""}function wordInSameField(control){var firstWord=omitirAcentos(cleanEmptySpaces($(control).val().toUpperCase())).split(" ");if(firstWord.length<=1){return""}var secondWord=firstWord;var message="Asegúrate de no capturar dos veces el mismo ";if(control=="#name"||control=="#secondname"){message+="nombre"}else{message+="apellido"}for(var n=0;n<firstWord.length;n++){for(var i=n+1;i<secondWord.length;i++){if(firstWord[n]==secondWord[i]){return message}}}return""}function wordInTwoFields(control,secondControl){var firstWord=omitirAcentos(cleanEmptySpaces($(control).val().toUpperCase())).split(" ");if(firstWord.length<1){$(control).parent().parent().find(".infoMessage").remove();$(secondControl).parent().parent().find(".infoMessage").remove();return}var secondWord=omitirAcentos(cleanEmptySpaces($(secondControl).val().toUpperCase())).split(" ");if(secondWord.length<1){return}var message="Asegúrate de no capturar dos veces el mismo nombre/apellido";for(var n=0;n<firstWord.length;n++){if(secondWord!=""){for(var i=0;i<secondWord.length;i++){if(firstWord[n]==secondWord[i]){return message}}}}return""};var SolicitudCreditoValidations={currentForm:null,formSubmit:false,exitCallbackFlag:0,defaultErrorMessages:{email:"El correo no es válido.",streets:"Caracteres no permitidos",required:"El campo es requerido.",minlength:"Ingresa al menos ??? caracteres",minlengthtel:"Revisa que tu teléfono sea de 10 dígitos",minlengthtelref:"Revisa que el teléfono sea de 10 dígitos",rfc:"El RFC es invalido.",matchinput:"El valor no coincide",NumExtValid:"Es requerido al menos un número",adultAge:"Debe ser mayor a 18 años.",termsAndConditions:"Debe aceptar los terminos y condiciones.",maxvalue:"Máximo permitido es ???.",minvalue:"Mínimo permitido es ???.",requiredRadio:" ",ageValidation:"El dato es incorrecto. Revísalo e intenta de nuevo.",nameValidation:"Revisa que tu nombre sea correcto.",lastnameValidation:"Revisa que tu apellido sea correcto.",nameAbreviationValidation:"Ingresa tu primer nombre sin abreviaturas",surnameAbreviationValidation:"Ingresa tu primer apellido sin abreviaturas",secondSurnameAbreviationValidation:"Ingresa tu segundo apellido sin abreviaturas"},customErrorMessages:{},checkSubmit:function(){$('button[type="submit"]').attr("disabled",true);if(!this.formSubmit){this.formSubmit=true;return true}else{return false}},validAge:function(yearElement,monthElement,dayElement){var currentDate=new Date();var validDate=new Date((currentDate.getFullYear()-18),currentDate.getMonth(),currentDate.getDate());var selectedDate=new Date($(yearElement).val(),(parseInt($(monthElement).val())-1),$(dayElement).val());return validDate>=selectedDate},setDayAvailable:function(yearElement,monthElement,dayElement){var lastDay_MonthYear=new Date(($(yearElement).val()||2019),parseInt($(monthElement).val()),0).getDate();var currentDaySelected=$(dayElement).val();$(dayElement).html("");var newOption=document.createElement("OPTION");newOption.value="";newOption.innerText="Día";newOption.setAttribute("hidden","hidden");$(dayElement).append(newOption);if(isNaN(lastDay_MonthYear)){for(var i=1;i<=31;i++){var newOptionDay=document.createElement("OPTION");newOptionDay.innerText=i;newOptionDay.value=(i<10?"0"+i:i);$(dayElement).append(newOptionDay)}}else{for(var j=1;j<=lastDay_MonthYear;j++){var newOptionDay2=document.createElement("OPTION");newOptionDay2.innerText=j;newOptionDay2.value=(j<10?"0"+j:j);$(dayElement).append(newOptionDay2)}}if(parseInt(currentDaySelected)>lastDay_MonthYear){$(dayElement).val(lastDay_MonthYear)}else{$(dayElement).val(currentDaySelected)}},validCalle:function(_input){var isValid;if(!$("input#input-calle-id").val()==""){isValid=true}else{isValid=false}return isValid},validKeyPressEvents:function(e){var $input=$(this);var dataValidTim=cleanEmptySpaces(this.getAttribute("data-valid"));var validations=(dataValidTim||"").split(",");var isValidChar=validateChar(validations,true,e,$input);var specialCase=false;if(isValidChar&&validations!=""){for(var j in validations){switch(validations[j]){case"numberformat":isValidChar=SolicitudCreditoValidations.validationNumberFormat(e,$input);break;case"maxvalue":isValidChar=SolicitudCreditoValidations.validationMaxValue(e,$input);break;case"streets":specialCase=true;break}if(!isValidChar){break}}}if(specialCase){isValidChar=SolicitudCreditoValidations.validateStreets(e.originalEvent.key)}else{if(isValidChar){isValidChar=SolicitudCreditoValidations.validationNotAllow(e)}}if(!isValidChar){e.preventDefault()}return isValidChar},validKeyUpEvents:function(_e){var $input=$(this);var dataValidTim=cleanEmptySpaces(this.getAttribute("data-valid"));var validations=((this.getAttribute("data-valid")&&dataValidTim)||"").split(",");if(validations!=""){for(var i in validations){switch(validations[i]){case"rfc":$input.val($input.val().toUpperCase());break;case"numberformat":var newValue=SolicitudCreditoValidations.clearNumberFormatValue($input.val());$input.val(newValue);break;default:break}}}if(this.hasAttribute("data-charcount")){const chartCountElement=$("#"+this.getAttribute("data-charcount"));if(chartCountElement.length>0){var currentText=chartCountElement.text();const str=$input.val();if(currentText.indexOf("/")>-1){currentText=currentText.split("/");currentText[0]=str.replace(/[^\d]/g,"").length;currentText=currentText.join("/")}else{currentText=str.replace(/[^\d]/g,"").length}chartCountElement.text(currentText)}}SolicitudCreditoValidations.validInput($input[0],"",true)},validateForm:function(form,properties){var isValid=true;var errorMessageAux="";var props=properties||{};var defaultProperties={scrollToError:true};for(var i in defaultProperties){if(!props[i]){props[i]=defaultProperties[i]}}SolicitudCreditoValidations.currentForm=form;var inputs=$(form).find("input[data-valid], select:required");inputs=inputs.filter(":visible");for(i=0;i<inputs.length;i++){var inputIsValid=true;if(inputs[i].hasAttribute("data-valid")&&inputs[i].getAttribute("data-valid")!=""){inputIsValid&=SolicitudCreditoValidations.validInput(inputs[i])}if(inputIsValid&&inputs[i].hasAttribute("required")){if(inputs[i].type=="checkbox"){inputIsValid=inputs[i].checked}else{inputIsValid=SolicitudCreditoValidations.validationNotEmpty(inputs[i].value)}if(!inputIsValid){if($(inputs[i]).hasClass("checkbox-terminos")){errorMessageAux=SolicitudCreditoValidations.getErrorMessageByInput(inputs[i],"termsAndConditions");SolicitudCreditoValidations.setInputError(inputs[i],errorMessageAux)}else{errorMessageAux=SolicitudCreditoValidations.getErrorMessageByInput(inputs[i],"required");SolicitudCreditoValidations.setInputError(inputs[i],errorMessageAux)}}else{if(inputs[i].type=="checkbox"){SolicitudCreditoValidations.clearInputStatus(inputs[i])}}if(inputIsValid){SolicitudCreditoValidations.setInputSuccess(inputs[i])}}isValid&=inputIsValid}if($("#birth_year").length>0){var birthValid=true;$("#birth_year").parent().parent().find(".errorMessage").remove();if($("#birth_year").val()>0&&$("#birth_month").val()>0&&$("#birth_day").val()>0){birthValid=SolicitudCreditoValidations.validAge("#birth_year","#birth_month","#birth_day");if(!birthValid){SolicitudCreditoValidations.setInputError($("#birth_year"),false);SolicitudCreditoValidations.setInputError($("#birth_month"),false);SolicitudCreditoValidations.setInputError($("#birth_day"),false);errorMessageAux=SolicitudCreditoValidations.getErrorMessageByInput($("#birth_year").get(0),"adultAge")}}else{birthValid&=SolicitudCreditoValidations.validInput($("#birth_year").get(0));birthValid&=SolicitudCreditoValidations.validInput($("#birth_month").get(0));birthValid&=SolicitudCreditoValidations.validInput($("#birth_day").get(0));SolicitudCreditoValidations.setDayAvailable("#birth_year","#birth_month","#birth_day");errorMessageAux=SolicitudCreditoValidations.getErrorMessageByInput($("#birth_year").get(0),"required")}if(!birthValid){var htmlMessage='<span data-abide-error="" class="alert callout error errorMessage" style="display: block;bottom: -10px;" aria-live="assertive">'+errorMessageAux+"</span>";$("#birth_year").parent().parent().append(htmlMessage)}isValid&=birthValid}if(!isValid&&props.scrollToError){var invalidInput=$(form).find("input.is-invalid-input, select.is-invalid-input")[0];if(invalidInput!=null){$([document.documentElement,document.body]).animate({scrollTop:($(invalidInput).offset().top-30)},(isMobile()?500:300),function(){invalidInput.focus()})}}return isValid},validInput:function(input,event,isFocused){isFocused=assignValues(isFocused,false);var errorMessageAux="";var isValid=true;var validations=assignValues(input.getAttribute("data-valid"),"").split(",");if(input){validateInputValue(input,validations,isFocused);var notEmptyValues=notEmptyValidation(input,isFocused,errorMessageAux,isValid);isValid=notEmptyValues.isValid;errorMessageAux=notEmptyValues.errorMessageAux;if(isValid&&cleanEmptySpaces(input.value)!=""){var inputsEvaluated=evaluateInputs(validations,input,isValid,errorMessageAux,isFocused,event);isValid=inputsEvaluated.isValid;errorMessageAux=inputsEvaluated.errorMessageAux}var extraVal=extraValidations(input,isFocused,isValid,errorMessageAux);var extraValExt=extraValidationsNumExt(input,isFocused,isValid,errorMessageAux);isValid=extraVal.isValid&&extraValExt.isValid}else{isValid=false}setAllInputSuccess(isValid,input,isFocused);SolicitudCreditoValidations.submitButtonAvailability();return isValid},minLengthValidation:function(input){var isValid=true;const minLength=input.getAttribute("minlength");const inputValueTrimed=cleanEmptySpaces(input.value);if(input&&input.value&&inputValueTrimed!=""&&minLength&&inputValueTrimed.length<parseInt(minLength)){isValid=false}return isValid},minValueValidation:function(input){var isValid=true;const minValue=input.getAttribute("data-minvalue");const inputValueTrimed=cleanEmptySpaces(input.value);if(input&&input.value&&inputValueTrimed!=""&&minValue&&parseFloat(inputValueTrimed)<parseFloat(minValue)){isValid=false}return isValid},maxValueValidation:function(input){var isValid=true;const maxValue=input.getAttribute("data-maxvalue");const inputValueTrimed=cleanEmptySpaces(input.value);if(input&&input.value&&inputValueTrimed!=""&&maxValue&&parseFloat(inputValueTrimed)>parseFloat(maxValue)){isValid=false}return isValid},validationNotEmpty:function(value){return value&&cleanEmptySpaces(value)!=""},validationCharactersAmerican:function(e){var k=document.getElementsByTagName("*")?e.keyCode:e.which;var validChars=[0,8,32,160,162];return(k>64&&k<91)||(k>=97&&k<=122)||validChars.indexOf(k)>-1},validationCharacters:function(e){var k=document.getElementsByTagName("*")?e.keyCode:e.which;var validChars=[0,8,32,237,160,162,233,225,243,250,193,218,211,201,205,241,209];return(k>64&&k<91)||(k>=97&&k<=122)||validChars.indexOf(k)>-1},validationNumeric:function(e){var k=document.getElementsByTagName("*")?e.keyCode:e.which;var validChars=[0,8];return(k>=48&&k<=57)||validChars.indexOf(k)>-1},validationAlphanumeric:function(e){var k=document.getElementsByTagName("*")?e.keyCode:e.which;var validChars=[0,8,32,237,160,162,233,225,243,250,193,218,211,201,205,241,209];return(k>64&&k<91)||(k>=97&&k<=122)||(k>=48&&k<=57)||validChars.indexOf(k)>-1},validationRFC:function(e){var k=document.getElementsByTagName("*")?e.keyCode:e.which;var validChars=[0,8,237,160,162,233,225,243,250,193,218,211,201,205,241,209];return(k>64&&k<91)||(k>=97&&k<=122)||(k>=48&&k<=57)||validChars.indexOf(k)>-1},validationMaxLength:function(input){var maxLength=$(input).attr("maxlength");var isValid=true;if(maxLength&&cleanEmptySpaces($(input).val())!=""){if(parseInt($(input).val().length)>=parseInt(maxLength)&&$(input).get(0)!=null&&$(input).get(0).selectionStart==$(input).get(0).selectionEnd){isValid=false}}return isValid},validationNumberFormat:function(e,input){var isValid=true;var $input=$(input);var checkValue=cleanEmptySpaces($input.val());if(checkValue!=""){var k=document.getElementsByTagName("*")?e.keyCode:e.which;if(checkValue=="0"){var isValidChart=SolicitudCreditoValidations.validationNumeric(e);if(isValidChart&&(k>=48&&k<=57)){$input.val(String.fromCharCode(k));isValid=false}}else{if(String.fromCharCode(k)=="0"&&$input.get(0).selectionStart==0){checkValue=checkValue.substr($input.get(0).selectionEnd,checkValue.length);if(checkValue==""){checkValue="0"}$input.val(parseInt(checkValue));$input.get(0).selectionStart=0;$input.get(0).selectionEnd=0;isValid=false}}}return isValid},validationMaxValue:function(e,input){var isValid=true;var $input=$(input);var checkValue=cleanEmptySpaces($input.val());var maxValue=parseFloat(cleanEmptySpaces($input.attr("data-maxvalue")));if(checkValue!=""&&!isNaN(maxValue)){var k=document.getElementsByTagName("*")?e.keyCode:e.which;var isValidChart=SolicitudCreditoValidations.validationNumeric(e);if(isValidChart&&(k>=48&&k<=57)){var keyValue=String.fromCharCode(k);var futureValue="";var firstSplitValue=checkValue.substr(0,$input.get(0).selectionStart);var secondSplitValue=checkValue.substr($input.get(0).selectionEnd,checkValue.length);var savedSelectionStart=$input.get(0).selectionStart+1;if($input.get(0).selectionEnd==$input.get(0).selectionStart){savedSelectionStart=$input.get(0).selectionEnd+1}futureValue=firstSplitValue+keyValue+secondSplitValue;if(!isNaN(futureValue)&&parseFloat(futureValue)>=maxValue){$input.val(maxValue);$input.get(0).selectionStart=savedSelectionStart;$input.get(0).selectionEnd=savedSelectionStart;isValid=false}}}return isValid},validationRadioRequired:function(input){var isValid=true;var inputName=input.getAttribute("name");if(inputName!=""){var selectedRadio=$('input[type="radio"][name="'+inputName+'"]:checked').length;if(selectedRadio<=0){isValid=false}}return isValid},validationNotAllow:function(e){var k=document.getElementsByTagName("*")?e.keyCode:e.which;var validChars=[33,34,36,37,38,39,40,41,42,43,47,58,59,60,61,62,63,91,92,93,123,125,161,170,183,186,191,199,231];return validChars.indexOf(k)==-1},clearCharacters:function(checkValue){var result="";var validChars=[0,8,32,237,233,225,243,250,193,218,211,201,205,241,209];for(var i=0;i<checkValue.length;i++){var currentChar=checkValue.charAt(i);if((currentChar.charCodeAt(0)>64&&currentChar.charCodeAt(0)<91)||(currentChar.charCodeAt(0)>=97&&currentChar.charCodeAt(0)<=122)||validChars.indexOf(currentChar.charCodeAt(0))>-1){result+=currentChar}}return result},clearNumeric:function(checkValue){var result="";var validChars=[0,8,32,237,233];for(var i=0;i<checkValue.length;i++){var currentChar=checkValue.charAt(i);if((currentChar.charCodeAt(0)>=48&&currentChar.charCodeAt(0)<=57)||validChars.indexOf(currentChar.charCodeAt(0))>-1){result+=currentChar}}return result},clearNumberFormatValue:function(value){var checkValue=cleanEmptySpaces(value);if(checkValue&&!isNaN(checkValue)&&checkValue.length>=2){checkValue=parseInt(checkValue)}return checkValue},clearAlphaNumeric:function(checkValue){var result="";var validChars=[0,8,32,237,233,97,122,225,243,250,193,218,211,201,205,241,209];for(var i=0;i<checkValue.length;i++){var currentChar=checkValue.charAt(i);if((currentChar.charCodeAt(0)>64&&currentChar.charCodeAt(0)<91)||(currentChar.charCodeAt(0)>=97&&currentChar.charCodeAt(0)<=122)||(currentChar.charCodeAt(0)>=48&&currentChar.charCodeAt(0)<=57)||validChars.indexOf(currentChar.charCodeAt(0))>-1){result+=currentChar}}return result},clearRFC:function(checkValue){var result="";var validChars=[0,8,237,233,97,122,225,243,250,193,218,211,201,205,241,209];for(var i=0;i<checkValue.length;i++){var currentChar=checkValue.charAt(i);if((currentChar.charCodeAt(0)>64&&currentChar.charCodeAt(0)<91)||(currentChar.charCodeAt(0)>=97&&currentChar.charCodeAt(0)<=122)||(currentChar.charCodeAt(0)>=48&&currentChar.charCodeAt(0)<=57)||validChars.indexOf(currentChar.charCodeAt(0))>-1){result+=currentChar}}return result},clearMaxLength:function(input){var maxLength=input[0].getAttribute("maxlength");var inputValue=cleanEmptySpaces(input[0].value);if(maxLength&&inputValue!=""){if(parseInt(inputValue)>=parseInt(maxLength)){inputValue=inputValue.substr(0,maxLength)}}return inputValue},setInputError:function(input,errorMessage){if(input){SolicitudCreditoValidations.clearInputStatus(input);var $input=$(input);$input.addClass("is-invalid-input");if($input.hasClass("no-error-message")){errorMessage=false}const errorText=(errorMessage?errorMessage:SolicitudCreditoValidations.defaultErrorMessages.required);const htmlMessage='<span data-abide-error="" class="alert callout error errorMessage" style="display: block;" aria-live="assertive">'+(errorMessage===false?"":'<span class="error-text">'+errorText+"</span>");if($input.attr("type")=="radio"){var $radioGroupParent=$input.parents(".radio-group");if($radioGroupParent.length<=0){$radioGroupParent=$input.parent().parent().parent()}SolicitudCreditoValidations.clearInputStatus($radioGroupParent,$radioGroupParent);$radioGroupParent.append(decodeValue(htmlMessage));$radioGroupParent.addClass("radio-error");$radioGroupParent.addClass("hasError")}else{$input.parent().addClass("hasError");$input.parent().append(decodeValue(htmlMessage))}}},clearInputStatus:function(input,parentElement){if(input){var $input=$(input);if($input.length&&($input.attr("data-lockerror")==undefined||$input.attr("data-lockerror")=="0")){var $parentElement=parentElement!=null?$(parentElement):$input.parent();if($input.type=="radio"){$parentElement=assignValuesConditional(parentElement==null&&($input.parents(".radio-group").length>0,$input.parents(".radio-group"),$input.parent().parent().parent()));$parentElement.removeClass("radio-error");$input.removeClass("radio-error")}$parentElement.find(".errorMessage, .icon-success").remove();$parentElement.removeClass("hasError");$input.removeClass("is-invalid-input").removeClass("success");$parentElement.find(".infoMessage").remove()}}},setInputSuccess:function(input){if(input){var $input=$(input);if(!$input.hasClass("success")&&($input.attr("data-lockerror")==undefined||$input.attr("data-lockerror")=="0")){SolicitudCreditoValidations.clearInputStatus(input);$input.addClass("success")}}},validateEmail:function(value){var emailRegex=/^[A-Z0-9-._%+-]{1,64}@(?:[A-Z0-9-]{1,63}\.){1,125}[A-Z]{2,4}$/i;return emailRegex.test(value)},validateStreets:function(value){var streetRegex=/^[a-zA-Z0-9,/ ñÑ]*$/;return streetRegex.test(value)},validRFC:function(value){var re=/^([A-ZÑ&]{3,4}) ?(?:- ?)?(\d{2}(?:0[1-9]|1[0-2])(?:0[1-9]|[12]\d|3[01])) ?(?:- ?)?([A-Z\d]{2})([A\d])$/;return value.match(re)},loadComboDates:function(birth_year,birth_month,birth_day){var birthDay_YearInputs=$(birth_year);var currentDate=new Date();var limitYear=(currentDate.getFullYear()-18);birthDay_YearInputs.html("");var newOption=document.createElement("OPTION");newOption.value="";newOption.innerText=inputPageName.value=="recuperacioncat"?"Elige el año":"Año";newOption.setAttribute("hidden","hidden");birthDay_YearInputs.append(newOption);for(var i=limitYear;i>=(currentDate.getFullYear()-75);i--){var newDate=document.createElement("OPTION");newDate.value=i;newDate.innerText=i;birthDay_YearInputs.append(newDate)}SolicitudCreditoValidations.setDayAvailable(birth_year,birth_month,birth_day)},disablePasterForm:function(form){$(form).on("cut copy paste",function(e){e.preventDefault()})},getErrorMessageByInput:function(input,errorMessageKey){var errorMessageText="",inputKey=input.getAttribute("data-inputkey")||input.getAttribute("name")||input.getAttribute("id"),customErrorMessages=SolicitudCreditoValidations.customErrorMessages;errorMessageKey=errorMessageKey?errorMessageKey:"required";if(customErrorMessages&&typeof customErrorMessages[inputKey]!="undefined"&&typeof customErrorMessages[inputKey][errorMessageKey]!="undefined"){errorMessageText=customErrorMessages[inputKey][errorMessageKey]}else{errorMessageText=typeof SolicitudCreditoValidations.defaultErrorMessages[errorMessageKey]!="undefined"?SolicitudCreditoValidations.defaultErrorMessages[errorMessageKey]:"El campo es requerido."}return errorMessageText},submitButtonAvailability:function(form){var formId=(typeof form=="string"?"#"+form:form);var forms=form!=null?formId:SolicitudCreditoValidations.currentForm;var invalidElements=$(forms).find("input:required, select:required, input[data-valid]");invalidElements=invalidElements.filter(":visible");var isFormValid=true;for(var i=0;i<invalidElements.length;i++){if(invalidElements[i].type=="checkbox"){if(!invalidElements[i].checked){isFormValid=false}}else{if(invalidElements[i].type=="radio"&&invalidElements[i].getAttribute("data-valid")&&invalidElements[i].getAttribute("data-valid").split(",").indexOf("required-radio")>-1&&invalidElements[i].getAttribute("name")){var inputsRadioWithName=document.querySelectorAll('input[type="radio"][name="'+invalidElements[i].getAttribute("name")+'"]');var isRadioValid=false;for(var j=0;j<inputsRadioWithName.length;j++){if(inputsRadioWithName[j].checked){isRadioValid=true;break}}if(!isRadioValid){isFormValid=false}}else{if(invalidElements[i].required&&invalidElements[i].className.indexOf("success")==-1){isFormValid=false;break}else{if(!invalidElements[i].required&&invalidElements[i].className.indexOf("is-invalid-input")>-1){isFormValid=false;break}}}}if(!isFormValid){break}}$(forms).find('button[type="submit"]').attr("disabled",!isFormValid)},getRandomNumber:function(){return getRandom()},emptySpaces:function(text){return cleanEmptySpaces(text)},validarTelRef:function(input){var solicitud_credito_values=JSON.parse((localStorage.solicitud_credito||"{}"));if(solicitud_credito_values.num_tel==input.value){return false}return true},};SolicitudCreditoValidations.customErrorMessages={name:{required:"Ingresa tu primer nombre para continuar"},lastname:{required:"Ingresa tu primer apellido para continuar"},email:{required:"Ingresa tu correo electrónico para continuar."},phone:{required:"Ingresa tu teléfono celular para continuar."},birth_day:{required:"Elige tu fecha de nacimiento para continuar"},birth_month:{required:"Elige tu fecha de nacimiento para continuar"},birth_year:{adultAge:"Debes ser mayor de 18 años para continuar",required:"Elige tu fecha de nacimiento para continuar"},phone_confirm:{required:"Confirma tu teléfono celular para continuar.",matchinput:"El número no coincide con el anterior"},"select-tarjeta":{required:"Elige una opción para continuar",},tarjeta_digitos:{required:"Ingresa los últimos 4 números de tu tarjeta para continuar",minlength:"Es requerido los últimos 4 números de tu tarjeta para continuar"},"input-codigo-postal":{required:"Ingresa el código postal para continuar",},"estado-select":{required:"Elige tu estado para continuar",},"municipio-select":{required:"Elige tu alcaldía o municipio para continuar",},"select-colonia":{required:"Elige tu colonia para continuar",},"input-calle":{required:"Ingresa tu calle para continuar",},"input-numero-exterior":{required:"Ingresa tu número exterior para continuar",},"input-entrecalle-1":{required:"Ingresa las calles cercanas a tu domicilio para continuar",},"input-entrecalle-2":{required:"Ingresa las calles cercanas a tu domicilio para continuar",},"input-domicilio-detalles":{required:"Ingresa alguna referencia para poder encontrar tu domicilio",},idu_gradoestudios:{required:"Elige tu último grado de estudios para continuar"},estado_civil:{required:"Elige tu estado civil para continuar"},tiempo_estado_civil_years:{required:"Ingresa los años para continuar"},tiempo_estado_civil_months:{required:"Ingresa los meses para continuar"},"select-tucasaes":{required:"Elige una opción para continuar"},"input-viviendocasa":{required:"Ingresa el tiempo que llevas viviendo en tu domicilio actual. Debe ser mayor a 0"},personas_viven_casa:{required:"Ingresa cuántas personas viven en tu casa"},personas_trabajan_casa:{required:"Ingresa cuántas personas de tu casa trabajan. Debe ser mayor a 0"},personas_dependen:{required:"Ingresa cuántas personas dependen de ti"},actividad:{required:"Elige una opción para continuar"},subactividad:{required:"Elige una opción para continuar"},"input-nombreempresa":{required:"Ingresa el nombre de la empresa para continuar"},"input-tiempotrabajando":{required:"Ingresa cuántos años llevas en tu trabajo actual para continuar. Debe ser mayor a 0"},"input-tiempotrabajoanterior":{required:"Ingresa los años que duraste en tu trabajo anterior para continuar "},"input-salario":{required:"Ingresa cuánto ganas al mes para continuar. Debe ser mayor a 0",maxlenght:"Ingresa máximo 6 dígitos",},"input-telefonooficina":{required:"Ingresa el teléfono de tu oficina para continuar"},"input-referencia-nombre":{required:"Ingresa el nombre de tu referencia personal para continuar"},"input-referencia-apellido":{required:"Ingresa el apellido de tu referencia personal para continuar"},genero_referencia:{required:"Elige una opción para terminar tu solicitud"},genero_referencia_mujer:{required:"Elige una opción para terminar tu solicitud"},genero_referencia_hombre:{required:"Elige una opción para terminar tu solicitud"},"select-parentesco":{required:"Elige el parentesco para continuar"},"input-referencia-telefono":{required:"Ingresa el teléfono de tu referencia para continuar",telRefDiffTel:"El número de tu referencia personal debe ser distinto al tuyo"},num_telefono_recuperacion:{required:"Escribe tu teléfono celular"},ref_birth_year:{required:"Elige la fecha de nacimiento para continuar",adultAge:"Debe ser mayor de 18 años para continuar"},};function isMobile(){var uAg=navigator.userAgent.toLowerCase();return !!uAg.match(/android|iphone|ipod|blackberry|symbianos/i)||$(window).width()<=700}function isIpad(){return !!uAg.match(/ipad/i)||($(window).width()>=768&&$(window).width()<=1024)}function isApple(){return !!uAg.match(/iphone|ipod|ipad/i)}function phoneFormat(input){input=input.replace(/\D/g,"");input=input.substring(0,10);var size=input.length;if(size==0){input=input}else{if(size<3){input=input.substring(0,2)+"-"}else{if(size<6){input=input.substring(0,2)+"-"+input.substring(2,6)}else{input=input.substring(0,2)+"-"+input.substring(2,6)+"-"+input.substring(6,10)}}}return input}function clearAllInputs(formId){const $formId=$(formId);var allInputs=$formId.find("input,select,textarea");for(var i in allInputs){if(typeof allInputs[i]=="object"&&i!="prevObject"){switch(allInputs[i].type.toLocaleLowerCase()){case"radio":case"checkbox":allInputs[i].checked=false;break;default:if(allInputs[i].name!=="id_token"){$(allInputs[i]).val("")}break}}}}$(document).ready(function(){window.readyToLoadCss=1});function omitirAcentos(text){var acentos="ÃÀÁÄÂÈÉËÊÌÍÏÎÒÓÖÔÙÚÜÛãàáäâèéëêìíïîòóöôùúüûÇç";var original="AAAAAEEEEIIIIOOOOUUUUaaaaaeeeeiiiioooouuuucc";for(var i=0;i<acentos.length;i++){text=text.replace(new RegExp(acentos.charAt(i),"g"),original.charAt(i))}return text}function checkLead(){localStorage.removeItem("app_origen");localStorage.removeItem("id_folioleads");localStorage.removeItem("numColaborador");localStorage.removeItem("utmSource");localStorage.removeItem("utmMedium");const urlParams=new URLSearchParams(encodeURI(window.location.search));if(urlParams.get("utm_content")!=undefined){localStorage.app_origen=urlParams.get("utm_content");if(urlParams.get("id_folioleads")!=undefined){localStorage.id_folioleads=urlParams.get("id_folioleads")}if(urlParams.get("utm_source")=="portale2e"){localStorage.numColaborador=urlParams.get("utm_campaign");localStorage.utmSource=urlParams.get("utm_source");localStorage.utmMedium=urlParams.get("utm_medium")}return true}else{return false}}function linkRedirect(redirect){const params=new URLSearchParams(window.location.search);if(checkLead()){const leadsTrack=redirect+(redirect.includes("?")?"&":"?")+params.toString();location.assign(leadsTrack)}else{location.assign(redirect)}}function filtroLocalStorage(datos){var keepValues=["nom_cliente","idu_cliente","idu_presolicitud","num_producto","num_tel","fec_nacimiento","tarjetaSolicitar","folioSolicitudBancoppel","folioSolicitudCoppel","descripcionSolicitudBancoppel","descripcionSolicitudCoppel","pscResultadoDescripcion","pscResultadoId","flag_canal_sic"];var filteredValues=JSON.parse("{}");for(var i in datos){if(keepValues.indexOf(i)>-1){filteredValues[i]=datos[i]}}localStorage.solicitud_credito=JSON.stringify(filteredValues)}function filtroCaracteresEspeciales(datos){var pattern=window.caracteresPermitidos;var callesValidas=JSON.parse("{}");var calle;for(var i in datos){calle=datos[i].descripcionCalle.replace(/ /g,"");if(pattern.test(calle)){callesValidas[i]=datos[i]}}return Object.values(callesValidas)}function saveValues(saveSetting){const isCheckedTerms=assignValuesConditional($(".checkbox-terminos").is(":checked"),1,0);const isCheckedBuro=assignValuesConditional($(".checkbox-buro").is(":checked"),1,0);const isCheckedTyC=assignValuesConditional($("#tyc-checkbox").is(":checked"),1,0);const isCheckedCar=assignValuesConditional($("#car-yes").is(":checked"),1,0);const isCheckedCredit=assignValuesConditional($("#credit-yes").is(":checked"),1,0);var dataNewValues={psc_prefolioid:assignValues(localStorage.pre_folio,"0"),idu_presolicitud:"0",nom_cliente:assignValues($("#name").val(),""),nom_nombreDosCliente:assignValues($("#secondname").val(),""),nom_primerApellido:assignValues($("#lastname").val(),""),nom_segundoApellido:assignValues($("#middlename").val(),""),desc_email:assignValues($("#email").val(),""),num_tel:($("#phone").length>0?($("#phone").val().replace(/-/g,"")):""),idu_estado:assignValues($("#estado-select").val(),""),idu_municipiodelegacion:assignValues($("#municipio-select").val(),""),num_status_avisoprivacidad:assignValuesConditional($(".checkbox-terminos").length>0,isCheckedTerms,""),flag_canal_sic:assignValues(localStorage.formType,""),idu_ciudad:assignValues($("#cuidad-select").val(),""),idu_colonia:assignValues($("select#select-colonia :selected").attr("clv"),""),desc_direccion:assignValues($("#input-calle").val(),""),desc_rfc:assignValues($("#rfc").val(),""),num_interior:assignValues($("#input-numero-interior").val(),""),num_exterior:assignValues($("#input-numero-exterior").val(),""),desc_entrecalle1:assignValues($("#input-entrecalle-1").val(),""),desc_entrecalle2:assignValues($("#input-entrecalle-2").val(),""),desc_cerca:assignValues($("#input-domicilio-detalles").val(),""),num_cp:assignValues($("#input-codigo-postal").val(),""),fec_nacimiento:assignValuesConditional($("#birth_year").length>0,$("#birth_year").val()+"-"+$("#birth_month").val()+"-"+$("#birth_day").val(),""),num_status_consultaburo:assignValuesConditional($(".checkbox-buro").length>0,isCheckedBuro,""),numStatusMediosElectronicos:assignValuesConditional($("#tyc-checkbox").length>0,isCheckedTyC,""),fec_progamado:"",idu_banco:assignBancoValue($("#select-tarjeta").val(),""),num_ultimosdigitos:assignValues($("#tarjeta_digitos").val(),""),num_status_creditoinmobiliario:assignValuesConditional($("#credit-yes").length>0,isCheckedCredit,""),num_status_creditoautomotriz:assignValuesConditional($("#car-yes").length>0,isCheckedCar,""),desc_genero:assignValues($('input[type="radio"][name="genero"]:checked').val(),""),idu_gradoestudios:assignValues($("#idu_gradoestudios").val(),""),clv_civil:assignValues($("#estado_civil").val(),""),idu_tipocasa:assignValues($("#select-tucasaes").val(),""),num_tiempocasado:assignValues($("#tiempo_estado_civil_years").val(),""),num_tiempomesescasado:assignValues($("#tiempo_estado_civil_months").val(),""),num_tiempoviviendocasa:assignValues($("#input-viviendocasa").val(),""),num_personascasa:assignValues($("#personas_viven_casa").val(),""),num_personastrabajan:assignValues($("#personas_trabajan_casa").val(),""),num_personasdependen:assignValues($("#personas_dependen").val(),""),nom_empresacliente:assignValues($("#input-nombreempresa").val(),""),num_tiempoempresacliente:assignValues($("#input-tiempotrabajando").val(),""),num_tiempoempresaanterior:assignValues($("#input-tiempotrabajoanterior").val(),""),idu_actividad:assignValues($("#actividad").val(),""),idu_subactividad:assignValues($("#subactividad").val(),""),num_sueldo:($("#input-salario").length>0?($("#input-salario").val().replace(/,/g,"")):""),num_teloficina:assignValues($("#input-telefonooficina").val(),""),flag_escelularoficina:assignValues($('input[type="radio"][name="flag_escelularoficina"]:checked').val(),""),nom_nombrereferencia:assignValues($("#input-referencia-nombre").val(),""),nom_segundonombrereferencia:assignValues($("#input-referencia-segundo-nombre").val(),""),nom_apellidoreferencia:assignValues($("#input-referencia-apellido").val(),""),nom_segundoapellidoreferencia:assignValues($("#input-referencia-segundo-apellido").val(),""),fec_nacimientoreferencia:assignValuesConditional($("#ref_birth_year").length>0,$("#ref_birth_year").val()+"-"+$("#ref_birth_month").val()+"-"+$("#ref_birth_day").val(),""),idu_parentesco:assignValues($("#select-parentesco").val(),""),desc_generoreferencia:assignValues($('input[type="radio"][name="genero_referencia"]:checked').val(),""),num_telreferencia:assignValues($("#input-referencia-telefono").val(),""),flag_escelularreferencia:assignValues($('input[type="radio"][name="flag_escelularreferencia"]:checked').val(),""),num_status_presolicitud:"",num_status_burocredito:"",num_status_cat:"",num_status_abandonado:"",num_status_credito:"",idu_calle:assignValues($("input#input-calle-id").val(),""),desc_zonahoraria:getTimeZone(),num_productoseleccionado:assignValues($("#input-tarjeta-seleccionada").val(),""),folioSolicitudBancoppel:"",folioSolicitudCoppel:"",descripcionSolicitudCoppel:"",descripcionSolicitudBancoppel:"",num_etapasolicitud:assignValues($("#num_etapa_solicitud").val(),""),utmContent:assignValues(localStorage.app_origen,"none"),numColaborador:assignValues(localStorage.numColaborador,"0"),utmMedium:assignValues(localStorage.utmMedium,"0"),utmSource:assignValues(localStorage.utmSource,"0")};if(conditionalAndCompressor(typeof saveSetting.isFirstSave!="undefined",saveSetting.isFirstSave)){localStorage.solicitud_credito="{}"}var oldValues=JSON.parse((localStorage.solicitud_credito||"{}"));processDataNewValues(dataNewValues);if(typeof saveSetting.isFirstSave=="undefined"||!saveSetting.isFirstSave){dataNewValues.idu_presolicitud=oldValues.idu_presolicitud}if(localStorage.solicitud_credito==null||localStorage.solicitud_credito=="{}"||!localStorage.solicitud_credito){filtroLocalStorage(dataNewValues)}var restUrl=window.restUrlPresolicitud;var tokenId=assignValuesConditional($("#id_token").length>0,$("#id_token").val(),"");restUrl+=assignValuesConditional(restUrl.indexOf("?")>-1,"&","?")+"token="+tokenId;restUrl+=assignValuesConditional(restUrl.indexOf("?")>-1,"&","?")+"utm="+(urlParams.get("utm_content")!=null?urlParams.get("utm_content"):"");Loading.show();$.ajax({url:restUrl,type:"POST",headers:{AdQKFIkT:localStorage.getItem("AdQKFIkT"),UdAgwnvI:localStorage.getItem("UdAgwnvI"),captcha_token:$("#captchatoken").val()},contentType:"application/json",dataType:"json",data:JSON.stringify(dataNewValues),success:function(result){if(result.statusCode==="400"){linkRedirect(window.tpErrorAlCrearToken);return}saveNewAuthToken(result);processResultPresolicitud(result,saveSetting);sendMedicionDigital(result)},error:function(error){console.log(error);if(typeof saveSetting.errorCallback=="function"){saveSetting.errorCallback.call(null)}else{redirectError()}}})}function buildXMLFile(datos){var stringXml='<?xml version="1.0" encoding="UTF-8" ?><requestPreCreditoCoppel>';for(var i in datos){datos[i]=datos[i]+"";var datosTrim=cleanEmptySpaces(datos[i]);if(typeof datos[i]!="undefined"&&datos[i]!=""&&datosTrim!=""){stringXml+="<"+i+">"+(typeof datos[i]!="undefined"?datos[i]:"")+"</"+i+">"}}stringXml+="</requestPreCreditoCoppel>";return stringXml}function onExitCallback(){if(SolicitudCreditoValidations.exitCallbackFlag){var oldValues=JSON.parse((localStorage.solicitud_credito||"{}"));if(!oldValues.idu_presolicitud||oldValues.idu_presolicitud==null){return true}var dataNewValues={idu_cliente:oldValues.idu_cliente||oldValues.idu_presolicitud||null,idu_presolicitud:oldValues.idu_presolicitud||null,desc_zonahoraria:getTimeZone()};dataNewValues=processDataOnExit(dataNewValues);var dataXML=buildXMLFile(dataNewValues);var restUrl=window.restUrlAbandonada;var tokenId=assignValuesConditional($("#id_token").length>0,$("#id_token").val(),"");restUrl+=assignValuesConditional(restUrl.indexOf("?")>-1,"&","?")+"token="+tokenId;restUrl+=assignValuesConditional(restUrl.indexOf("?")>-1,"&","?")+"utm="+(urlParams.get("utm_content")!=null?urlParams.get("utm_content"):"");$.ajax({url:restUrl,type:"POST",headers:{AdQKFIkT:localStorage.getItem("AdQKFIkT"),UdAgwnvI:localStorage.getItem("UdAgwnvI")},contentType:"application/xml",dataType:"json",data:dataXML,success:function(result){if(result.statusCode==="400"){linkRedirect(window.tpErrorAlCrearToken);return}saveNewAuthToken(result);console.log(result)},error:function(error){console.log(error)}})}}function getTimeZone(){var today=(new Date).toLocaleString("en-US",{hour12:false,hour:"2-digit",timeZoneName:"long"}).replace(/^\d\d /,"");if(today.indexOf("Mexican Pacific Standard Time")!=-1){today="MST"}else{if(today.indexOf("Mexican Pacific Daylight Time")!=-1){today="MDT"}else{if((today.indexOf("Pacific Standard Time")!=-1)||(today.indexOf("Pacific Daylight Time")!=-1)){today="PST"}else{if(today.indexOf("US Mountain Standard Time")!=-1){today="PNT"}else{if((today.indexOf("Mountain Standard Time")!=-1)||(today.indexOf("Mountain Daylight Time")!=-1)){today="MST"}else{if((today.indexOf("Central Standard Time")!=-1)||(today.indexOf("Central Daylight Time")!=-1)){today="CST"}else{if((today.indexOf("Eastern Standard Time")!=-1)||(today.indexOf("Eastern Daylight Time")!=-1)){today="EST"}else{today="MST"}}}}}}}return today}var preloadStyles=document.getElementById("preload-styles");if(preloadStyles!=null){preloadStyles.remove()}function setClientData(){var solicitud_credito_values=JSON.parse((localStorage.solicitud_credito||"{}"));var clientNameTag=document.getElementById("client_name");if(clientNameTag!=null&&solicitud_credito_values.nom_cliente!=null&&solicitud_credito_values.nom_cliente.length>=2){var nom_clienteTrim=cleanEmptySpaces(solicitud_credito_values.nom_cliente);var nom_cliente=nom_clienteTrim.toLocaleLowerCase().split(" ");var notUppercaseValus=["DEL","LAS","DE","LA","EL","Y","A","DA","DAS","DER","DI","DIE","DD","EL","LA","LOS","LAS","LE","LES","MAC","MC","VAN","VON"];for(var i in nom_cliente){if(i==0||notUppercaseValus.indexOf(nom_cliente[i].toUpperCase())==-1){nom_cliente[i]=nom_cliente[i].toLocaleLowerCase().charAt(0).toUpperCase()+nom_cliente[i].toLocaleLowerCase().slice(1)}}clientNameTag.innerText=nom_cliente.join(" ")}var clientPhoneTag=document.getElementsByName("client_phone");for(var i=0;i<clientPhoneTag.length;i++){if(clientPhoneTag[i]!=null&&solicitud_credito_values.num_tel!=null&&solicitud_credito_values.num_tel.length>0){var numTel=solicitud_credito_values.num_tel;clientPhoneTag[i].innerText="******"+numTel.substr(numTel.length-4)}}}setClientData();var Loading={completedInterval:null,slidesInterval:null,loadingShowDelay:1000,loadintToShowInterval:null,show:function(){Loading.loadintToShowInterval=setTimeout(function(){var loader=document.getElementById("loadingv2");if(loader!=null){document.body.classList.add("loading");loader.style.display="block";$("html, body").animate({scrollTop:0},"smooth");Loading.loadingStart()}},Loading.loadingShowDelay)},hide:function(){var loader=document.getElementById("loadingv2");if(loader!=null){document.body.classList.remove("loading");loader.style.display="none";if(Loading.completedInterval!=null){clearInterval(Loading.completedInterval);Loading.completedInterval=null}if(Loading.slidesInterval!=null){clearInterval(Loading.slidesInterval);Loading.slidesInterval=null}if(Loading.loadintToShowInterval!=null){clearInterval(Loading.loadintToShowInterval);Loading.loadintToShowInterval=null}$(loader).find(".animated").removeClass("animated")}},loadingStart:function(){var loader=document.getElementById("loadingv2");var completed=loader.querySelector(".loading-bar-completed");completed.setAttribute("data-completed",0);completed.style.width=0+"%";loader.querySelector("#loading-count").innerText=0+"%";Loading.barPlay();Loading.slidesPlay()},barPlay:function(){if(Loading.completedInterval!=null){clearInterval(Loading.completedInterval)}Loading.barNext();Loading.completedInterval=setInterval(Loading.barNext,3000)},barNext:function(){var loader=document.getElementById("loadingv2");var completed=loader.querySelector(".loading-bar-completed");var randValue=getRandom();var lessEighty=randValue<0.8?20:25;var newCompleted=parseInt(completed.getAttribute("data-completed")||0)+(randValue<0.4?15:lessEighty);if(newCompleted>=95){newCompleted=95;clearInterval(Loading.completedInterval);Loading.completedInterval=null}completed.style.width=newCompleted+"%";loader.querySelector("#loading-count").innerText=newCompleted+"%";completed.setAttribute("data-completed",newCompleted)},slidesPlay:function(){Loading.slidesStop();setTimeout("Loading.slidesNext(0)",300);Loading.slidesInterval=setInterval(Loading.slidesNext,4500)},slidesNext:function(goToSlide){var loader=document.getElementById("loadingv2");var allSlides=loader.querySelectorAll(".loading-slides");var currentSlideIndex=false;var nextSlide=0;var processedSlides=processAllSlides(allSlides,currentSlideIndex);allSlides=processedSlides.allSlides;currentSlideIndex=processedSlides.currentSlideIndex;if(currentSlideIndex!==false){if((currentSlideIndex+1)<allSlides.length){nextSlide=currentSlideIndex+1}allSlides[currentSlideIndex].classList.add("out");allSlides[currentSlideIndex].classList.remove("active");var allAnimatedItems=allSlides[currentSlideIndex].querySelectorAll(".animated");processAllAnimatedItems(allAnimatedItems)}if(typeof goToSlide!="undefined"){nextSlide=goToSlide}allSlides[nextSlide].classList.add("active");var animatedElement=allSlides[nextSlide].querySelectorAll("[data-animate]");if(animatedElement.length>0){for(var k in animatedElement){if(typeof animatedElement[k]=="object"&&k!="prevObject"){animateCSS(animatedElement[k],animatedElement[k].getAttribute("data-animate"))}}}loader.classList.remove("coppel");loader.classList.remove("bancoppel");switch(allSlides[nextSlide].getAttribute("data-type")){case"coppel":loader.classList.add("coppel");break;case"bancoppel":loader.classList.add("bancoppel");break;default:break}},slidesStop:function(){if(Loading.slidesInterval!=null){clearInterval(Loading.slidesInterval);Loading.slidesInterval=null}},loadingFinish:function(){var loader=document.getElementById("loadingv2");var completed=loader.querySelector(".loading-bar-completed");var newCompleted=100;completed.style.width=newCompleted+"%";loader.querySelector("#loading-count").innerText=newCompleted+"%";if(Loading.completedInterval!=null){clearInterval(Loading.completedInterval);Loading.completedInterval=null}}};function validarInformacionCrediticiaAjax(formActionUrl){var solicitud_credito_values=JSON.parse((localStorage.solicitud_credito||"{}"));if(!solicitud_credito_values.idu_presolicitud){return false}var restUrl=window.validarInformacionCrediticia.replace("{idu_presolicitud}",solicitud_credito_values.idu_presolicitud);var tokenId=($("#id_token").length>0?$("#id_token").val():"");restUrl+=(restUrl.indexOf("?")>-1?"&":"?")+"token="+tokenId;restUrl+=assignValuesConditional(restUrl.indexOf("?")>-1,"&","?")+"utm="+(urlParams.get("utm_content")!=null?urlParams.get("utm_content"):"");$.ajax({url:restUrl,type:"POST",headers:{AdQKFIkT:localStorage.getItem("AdQKFIkT"),UdAgwnvI:localStorage.getItem("UdAgwnvI")},contentType:"application/xml",dataType:"json",data:"",success:function(response){if(response.statusCode==="400"){linkRedirect(window.tpErrorAlCrearToken);return}saveNewAuthToken(response);SolicitudCreditoValidations.exitCallbackFlag=0;sendMedicionDigital(response);if(response.code=="AUTENTICADO"||response.code=="SUCCESS"||response.code=="SUCCESS_FAILED"||response.code=="FAILED_SIC"){if(typeof formActionUrl!="undefined"&&typeof formActionUrl.callback=="function"){formActionUrl.callback.call(this,response)}else{Loading.loadingFinish();linkRedirect(formActionUrl)}}else{if(response.code=="NO_AUTENTICADO"){linkRedirect(window.tpNoAutenticado)}else{linkRedirect(window.tpGenericError)}}},error:function(error){console.log(error);SolicitudCreditoValidations.exitCallbackFlag=0;linkRedirect(window.tpGenericError)}})}function checkToken(){Loading.show();var result="/pagina-no-encontrada";if(localStorage.uuidToken!=""&&localStorage.uuidToken!=undefined){switch(window.location.hostname){case"localhost":case window.urlE2EHostNameDev:result=window.urlE2EDev+localStorage.uuidToken;break;case window.urlE2EHostNameQA:result=window.urlE2EQA+localStorage.uuidToken;break;case window.urlE2EHostNamePro:result=window.urlE2EPro+localStorage.uuidToken;break}}return result}function validarParametricoAjax(formAction){localStorage.removeItem("uuidToken");var solicitud_credito_values=JSON.parse((localStorage.solicitud_credito||"{}"));if(!solicitud_credito_values.idu_presolicitud){return false}var restUrl=window.validarParametrico.replace("{idu_presolicitud}",solicitud_credito_values.idu_presolicitud);var tokenId=assignValuesConditional($("#id_token").length>0,$("#id_token").val(),"");restUrl+=assignValuesConditional(restUrl.indexOf("?")>-1,"&","?")+"token="+tokenId;restUrl+=assignValuesConditional(restUrl.indexOf("?")>-1,"&","?")+"utm="+(urlParams.get("utm_content")!=null?urlParams.get("utm_content"):"");$.ajax({url:restUrl,type:"POST",headers:{AdQKFIkT:localStorage.getItem("AdQKFIkT"),UdAgwnvI:localStorage.getItem("UdAgwnvI")},contentType:"application/xml",dataType:"json",data:"",success:function(response){if(response.statusCode==="400"){linkRedirect(window.tpErrorAlCrearToken);return}saveNewAuthToken(response);Loading.loadingFinish();console.log(response);var oldValues=JSON.parse((localStorage.solicitud_credito||"{}"));sendMedicionDigital(response);if(response.data){var data=JSON.parse(response.data);oldValues.folioSolicitudBancoppel=data.folioSolicitudBancoppel||"";oldValues.folioSolicitudCoppel=data.folioSolicitudCoppel||"";oldValues.descripcionSolicitudCoppel=data.descripcionSolicitudCoppel||"";oldValues.descripcionSolicitudBancoppel=data.descripcionSolicitudBancoppel||""}else{if(response.code=="SUCCESS"){oldValues.folioSolicitudBancoppel=9222221;oldValues.folioSolicitudCoppel=9111112;oldValues.descripcionSolicitudCoppel="El servicio esta apagado.";oldValues.descripcionSolicitudBancoppel="El servicio esta apagado."}}if(response.code_token!=undefined&&response.code_token!=""){if(response.code_token=="SUCCESS"){localStorage.uuidToken=response.token.uuidToken;response.code="SUCCESS_TOKEN"}else{if(response.code_token=="FAILED_TOKEN"){response.code="FAILED_TOKEN"}}}localStorage.solicitud_credito=JSON.stringify(oldValues);if(typeof formAction!="undefined"&&typeof formAction.callback=="function"){formAction.callback.call(this,response)}else{SolicitudCreditoValidations.exitCallbackFlag=0;if(typeof responsesParametricoUrls[response.code]!="undefined"){linkRedirect(responsesParametricoUrls[response.code])}else{linkRedirect(window.tpGenericError)}}},error:function(error){errorAjax(error)}})}function errorAjax(err){console.log(err);SolicitudCreditoValidations.exitCallbackFlag=0;redirectError()}function redirectError(){linkRedirect(window.tpGenericError)}function codigoVerificacionAjax(formActionUrl){var solicitud_credito_values=JSON.parse(assignValues(localStorage.solicitud_credito,"{}"));if(!solicitud_credito_values.idu_presolicitud){return false}var restUrl=window.codigoVerificacion.replace("{idu_presolicitud}",solicitud_credito_values.idu_presolicitud);var tokenId=assignValuesConditional($("#id_token").length>0,$("#id_token").val(),"");restUrl+=assignValuesConditional(restUrl.indexOf("?")>-1,"&","?")+"utm="+(urlParams.get("utm_content")!=null?urlParams.get("utm_content"):"");$.ajax({url:restUrl,type:"GET",headers:{AdQKFIkT:localStorage.getItem("AdQKFIkT"),UdAgwnvI:localStorage.getItem("UdAgwnvI")},contentType:"application/xml",dataType:"json",data:"",success:function(response){if(response.statusCode==="400"){linkRedirect(window.tpErrorAlCrearToken);return}saveNewAuthToken(response);SolicitudCreditoValidations.exitCallbackFlag=0;if(response.code=="SUCCESS"){Loading.loadingFinish();if(formActionUrl){linkRedirect(formActionUrl)}$(".resend-container").addClass("show-nip-msg");localStorage.setItem("tpIntentos",false);setTimeout(function(){$(".resend-container").removeClass("show-nip-msg")},7000)}else{if(response.code=="FAILED_INTENTOS"){linkRedirect(window.tpIntentos)}else{if(response.code=="OFF"){selectProduct(solicitud_credito_values.num_producto)}else{if(response.code=="FAILED_SEND_SMS"||response.code=="FAILED_CONECTION_SMS"){redirectError()}else{redirectError()}}}}},error:function(_error){SolicitudCreditoValidations.exitCallbackFlag=0;redirectError()}})}var numIntentosCodigoValidacion=0;function codigoValidacionAjax(formActionUrl){var page_name=document.getElementById("page_name").value;var solicitud_credito_values=JSON.parse((localStorage.solicitud_credito||"{}"));if(!solicitud_credito_values.idu_presolicitud){return false}var flagConsultaburo;if(localStorage.formType==2&&page_name=="nip"){flagConsultaburo=true}else{flagConsultaburo=false}var codigo=$("#codigo_1").val()+$("#codigo_2").val()+$("#codigo_3").val()+$("#codigo_4").val();var restUrl=window.codigoValidacion.replace("{idu_presolicitud}",solicitud_credito_values.idu_presolicitud).replace("{codigo}",codigo).replace("{flagConsultaburo}",flagConsultaburo);var tokenId=assignValuesConditional($("#id_token").length>0,$("#id_token").val(),"");restUrl+=assignValuesConditional(restUrl.indexOf("?")>-1,"&","?")+"token="+tokenId;restUrl+=assignValuesConditional(restUrl.indexOf("?")>-1,"&","?")+"utm="+(urlParams.get("utm_content")!=null?urlParams.get("utm_content"):"");$.ajax({url:restUrl,type:"GET",headers:{AdQKFIkT:localStorage.getItem("AdQKFIkT"),UdAgwnvI:localStorage.getItem("UdAgwnvI")},contentType:"application/xml",dataType:"json",data:"",success:function(response){if(response.statusCode==="400"){linkRedirect(window.tpErrorAlCrearToken);return}saveNewAuthToken(response);SolicitudCreditoValidations.exitCallbackFlag=0;if(response.code&&response.code=="SUCCESS"){localStorage.celularConfirmado=1;validationCodeSuccessAjax(formActionUrl,response)}else{if(typeof formActionUrl=="object"&&typeof formActionUrl.errorCallback=="function"){formActionUrl.callback.errorCallback(this,result)}else{if(conditionalAndCompressor(response.code!=null,response.code=="FAILED_INTENTOS")){SolicitudCreditoValidations.exitCallbackFlag=0;linkRedirect(window.tpIntentos)}else{if(response.code=="OFF"){Loading.loadingFinish();linkRedirect(window.urlProductos)}else{if(response.code!=null&&response.code=="FAILED"){$("#codigo_1,#codigo_2,#codigo_3,#codigo_4").val("");SolicitudCreditoValidations.setInputError($("#codigo_1").get(0));SolicitudCreditoValidations.setInputError($("#codigo_2").get(0));SolicitudCreditoValidations.setInputError($("#codigo_3").get(0));SolicitudCreditoValidations.setInputError($("#codigo_4").get(0));SolicitudCreditoValidations.submitButtonAvailability();SolicitudCreditoValidations.exitCallbackFlag=1;$(".nip-error-content").show();if(flagConsultaburo){for(var i in nipInputsMatch){$(nipInputsMatch[i]).val("");SolicitudCreditoValidations.clearInputStatus($(nipInputsMatch[i]));$(nipInputsMatch[i]).attr("disabled",true);$("#codigo_2,#codigo_3,#codigo_4").attr("disabled",true)}}$("#codigo_1").focus().focusin();Loading.hide()}}}}}},error:function(_error){SolicitudCreditoValidations.exitCallbackFlag=0;redirectError()}})}function validacionSolicitudTelefono(formActionUrl){var numcelular=$("#num_telefono_recuperacion").val();localStorage.numcelular=numcelular;var restUrl=window.validarSolicitudPendiente.replace("{num_celular}",numcelular);var tokenId=assignValuesConditional($("#id_token").length>0,$("#id_token").val(),"");restUrl+=assignValuesConditional(restUrl.indexOf("?")>-1,"&","?")+"token="+tokenId;restUrl+=assignValuesConditional(restUrl.indexOf("?")>-1,"&","?")+"utm="+(urlParams.get("utm_content")!=null?urlParams.get("utm_content"):"");$.ajax({url:restUrl,type:"POST",headers:{AdQKFIkT:localStorage.getItem("AdQKFIkT"),UdAgwnvI:localStorage.getItem("UdAgwnvI")},contentType:"application/xml",dataType:"json",data:"",success:function(response){if(response.statusCode==="400"){linkRedirect(window.tpErrorAlCrearToken);return}saveNewAuthToken(response);SolicitudCreditoValidations.exitCallbackFlag=0;if(response.code=="SUCCESS"){localStorage.presolicitudId=response.data.idu_presolicitud;filtroLocalStorage(response.data);Loading.loadingFinish();linkRedirect(formActionUrl)}else{if(response.code=="FAILED"){Loading.hide();SolicitudCreditoValidations.setInputError($("#num_telefono_recuperacion"),response.message)}else{if(response.code=="FAILED_INTENTOS"){linkRedirect(window.tpIntentos)}else{console.log(response.message);redirectError()}}}},error:function(_error){SolicitudCreditoValidations.exitCallbackFlag=0;redirectError()}})}function recuperarInformacionSolicitudPendiente(_formActionUrl){$(".nip-generic-error").hide();var presolicitudId=assignValues(localStorage.presolicitudId,"");if(!presolicitudId){return false}var restUrl=window.recuperarInformacionSolicitud.replace("{idu_presolicitud}",presolicitudId);var tokenId=assignValuesConditional($("#id_token").length>0,$("#id_token").val(),"");restUrl+=assignValuesConditional(restUrl.indexOf("?")>-1,"&","?")+"token="+tokenId;restUrl+=assignValuesConditional(restUrl.indexOf("?")>-1,"&","?")+"utm="+(urlParams.get("utm_content")!=null?urlParams.get("utm_content"):"");$.ajax({url:restUrl,type:"POST",headers:{AdQKFIkT:localStorage.getItem("AdQKFIkT"),UdAgwnvI:localStorage.getItem("UdAgwnvI")},contentType:"application/xml",dataType:"json",data:"",success:function(response){if(response.statusCode==="400"){linkRedirect(window.tpErrorAlCrearToken);return}saveNewAuthToken(response);setTimeout(function(){Loading.hide()},300);if(response.data){filtroLocalStorage(response.data[0]);localStorage.celularConfirmado=response.data[0].celularConfirmado;localStorage.removeItem("recuperacionCAT");const formType=response.data[0].flag_canal_sic;localStorage.formType=formType;if(response.etapa){handlePhasePending(response.etapa,response.code,response.message)}}else{if(response.code=="SINPRODUCTOS"||response.code=="FAILED_PRODUCTOS"){linkRedirect(window.tpSinProducto)}else{if(response.code=="NO_AUTENTICADO"){linkRedirect(window.tpNoAutenticado)}else{$(".nip-generic-error").html(sanitisingValue(response.message)).show()}}}},error:function(_error){SolicitudCreditoValidations.exitCallbackFlag=0;$(".nip-generic-error").html("Ocurrió un error.").show();setTimeout(function(){Loading.hide()},300)}})}function autenticarSolicitudCAT(){const urlParams=new URLSearchParams(encodeURI(window.location.search));var idu_presolicitud=urlParams.get("id_presolicitud")||"";var birth_year=$("#select-year").val();if(!idu_presolicitud){return false}var restUrl=window.restUrlAutenticacionRescateCAT.replace("{idu_presolicitud}",idu_presolicitud).replace("{birth_year}",birth_year);var tokenId=assignValuesConditional($("#id_token").length>0,$("#id_token").val(),"");restUrl+=assignValuesConditional(restUrl.indexOf("?")>-1,"&","?")+"token="+tokenId;restUrl+=assignValuesConditional(restUrl.indexOf("?")>-1,"&","?")+"utm="+(urlParams.get("utm_content")!=null?urlParams.get("utm_content"):"");$.ajax({url:restUrl,type:"GET",headers:{AdQKFIkT:localStorage.getItem("AdQKFIkT"),UdAgwnvI:localStorage.getItem("UdAgwnvI")},contentType:"application/xml",dataType:"json",data:"",success:function(response){if(response.statusCode==="400"){linkRedirect(window.tpErrorAlCrearToken);return}saveNewAuthToken(response);SolicitudCreditoValidations.exitCallbackFlag=0;if(response.data.status_autenticacion=="0002"){$(".error-match-content").show();SolicitudCreditoValidations.setInputError($("#select-year").get(0));$(".generic-error-content").hide();setTimeout(function(){Loading.hide()},500)}else{if(response.data.status_autenticacion=="0001"){$(".error-match-content").hide();$(".generic-error-content").hide();recuperarInformacionSolicitudCAT()}else{return false}}},error:function(_error){SolicitudCreditoValidations.setInputError($("#select-year").get(0));$(".generic-error-content").html("Ocurrió un error.").show();setTimeout(function(){Loading.hide()},500);return false}})}function recuperarInformacionSolicitudCAT(_formActionUrl){const urlParams=new URLSearchParams(encodeURI(window.location.search));var idu_cliente=urlParams.get("id_presolicitud")||"";if(!idu_cliente){return false}var restUrl=window.restUrlRecuperarSolicitudCAT.replace("{idu_cliente}",idu_cliente);var tokenId=assignValuesConditional($("#id_token").length>0,$("#id_token").val(),"");restUrl+=assignValuesConditional(restUrl.indexOf("?")>-1,"&","?")+"token="+tokenId;restUrl+=assignValuesConditional(restUrl.indexOf("?")>-1,"&","?")+"utm="+(urlParams.get("utm_content")!=null?urlParams.get("utm_content"):"");Loading.show();$.ajax({url:restUrl,type:"POST",headers:{AdQKFIkT:localStorage.getItem("AdQKFIkT"),UdAgwnvI:localStorage.getItem("UdAgwnvI")},contentType:"application/xml",dataType:"json",data:"",success:function(response){if(response.statusCode==="400"){linkRedirect(window.tpErrorAlCrearToken);return}saveNewAuthToken(response);setTimeout(function(){Loading.hide()},500);if(response.data){filtroLocalStorage(response.data[0]);localStorage.celularConfirmado=response.data[0].celularConfirmado;localStorage.recuperacionCAT=true;const formType=response.data[0].flag_canal_sic;localStorage.formType=formType;localStorage.autentico_buro=response.data[0].autentico_buro;localStorage.etapaCliente=response.data[0].num_etapasolicitud}if(response.etapa){handlePhaseCAT(response.etapa,response.code,response.data)}else{if(response.code=="SINPRODUCTOS"){SolicitudCreditoValidations.exitCallbackFlag=0;window.location.href=window.tpSinProducto}else{if(response.code=="NO_AUTENTICADO"){window.location.href=window.tpNoAutenticado}else{$(".generic-error-content").html(sanitisingValue(response.code)+"</br> Ocurrió un error").show()}}}},error:function(_error){SolicitudCreditoValidations.exitCallbackFlag=0;$(".generic-error-content").html("Ocurrió un error").show();setTimeout(function(){Loading.hide()},500)}})}var timer=null;function iniciarSesion(){if(!localStorage.recuperacionCAT){var tiempoMs=1000*60*window.sesionTime;if(timer){clearTimeout(timer);timer=null}timer=setTimeout(function(){linkRedirect(window.urlSolicitudPendiente)},tiempoMs)}}function ageValidation(input,error){if(error){SolicitudCreditoValidations.setInputError(input.get(0),SolicitudCreditoValidations.defaultErrorMessages.ageValidation);pageNameTagsError(SolicitudCreditoValidations.defaultErrorMessages.ageValidation,input.get(0));input.attr("data-lockerror",1).attr("data-lastvalue",input.val()).focus().focusin()}else{input.attr("data-lockerror",0);SolicitudCreditoValidations.validInput(input.get(0))}}function getAge(){var solicitud_credito_values=JSON.parse((localStorage.solicitud_credito||"{}"));var fec_nacimiento=solicitud_credito_values&&solicitud_credito_values.fec_nacimiento?solicitud_credito_values.fec_nacimiento:"";if(fec_nacimiento){fec_nacimiento=fec_nacimiento.replace(/-/gi,"/");var fechaNacimiento=new Date(fec_nacimiento);var anioNacimiento=fechaNacimiento.getYear();var mesNacimiento=fechaNacimiento.getMonth()+1;var diaNacimiento=fechaNacimiento.getDate();var fechaActual=new Date();var anioActual=fechaActual.getYear();var mesActual=fechaActual.getMonth()+1;var diaActual=fechaActual.getDate();var anios=(anioActual+1990)-anioNacimiento;if(mesActual<mesNacimiento||((mesNacimiento==mesActual)&&(diaActual<diaNacimiento))){anios--}if(anios>1990){anios-=1990}return anios}}function animateCSS(elementSelector,animationName,callback){var element=null;if(typeof elementSelector=="string"){element=document.querySelector(elementSelector)}else{if(typeof element=="object"&&typeof elementSelector.tagName!="undefined"){element=elementSelector}else{return false}}element.classList.add("animated",animationName);function handleAnimationEnd(){element.classList.remove("animated",animationName);element.removeEventListener("animationend",handleAnimationEnd);if(typeof callback==="function"){callback()}}element.addEventListener("animationend",handleAnimationEnd)}function getRandom(){var byteArray=new Uint32Array(1);window.crypto.getRandomValues(byteArray);var randomNum="0."+byteArray[0].toString();randomNum=parseFloat(randomNum);return randomNum}function sanitisingValue(value){return decodeValue(value).toString().replace(/\&/g,"&amp;").replace(/\</g,"&lt;").replace(/\>/g,"&gt;").replace(/\"/g,"").replace(/\'/g,"").replace(/\//g,"&#x2F")}function decodeValue(value){return decodeURIComponent(encodeURIComponent(value))}function cleanEmptySpaces(text){return(text||"").replace(/^\s+|\s+$/g,"")}function validateChar(validations,value,e,$input){var isValidChar=value;if(validations!=""){for(var i in validations){switch(validations[i]){case"character_american":isValidChar=SolicitudCreditoValidations.validationCharactersAmerican(e);break;case"character":isValidChar=SolicitudCreditoValidations.validationCharacters(e);break;case"numeric":isValidChar=SolicitudCreditoValidations.validationNumeric(e);break;case"alphanumeric":isValidChar=SolicitudCreditoValidations.validationAlphanumeric(e);break;case"rfc":isValidChar=SolicitudCreditoValidations.validationRFC(e);break;case"maxlength":isValidChar=SolicitudCreditoValidations.validationMaxLength($input);break;default:break}if(!isValidChar){break}}}return isValidChar}function setInputErrorRadioGroup(input){var $radioGroupParent=input.parents(".radio-group");if($radioGroupParent.length<=0){$radioGroupParent=input.parent().parent().parent()}SolicitudCreditoValidations.clearInputStatus($radioGroupParent,$radioGroupParent);$radioGroupParent.append(decodeValue(htmlMessage));$radioGroupParent.addClass("radio-error");$radioGroupParent.addClass("hasError")}function assignValuesConditional(condition,value,valueNegative){if(condition){return value}return valueNegative}function assignValues(value,defaultValue){if(value){return value}return defaultValue}function assignBancoValue(value,defaultValue){if(localStorage.formType==2){return -1}else{if(value){return value}}return defaultValue}function validateInputValue(input,validations,isFocused){var $input=$(input);if(!isFocused){if(validations.length>0){for(var i in validations){switch(validations[i]){case"character":$input.val(SolicitudCreditoValidations.clearCharacters($input.val()));break;case"numeric":$input.val(SolicitudCreditoValidations.clearNumeric($input.val()));break;case"alphanumeric":$input.val(SolicitudCreditoValidations.clearAlphaNumeric($input.val()));break;case"rfc":$input.val(SolicitudCreditoValidations.clearRFC($input.val()));break;case"maxlength":$input.val(SolicitudCreditoValidations.clearMaxLength($input));break;case"numberformat":$input.val(SolicitudCreditoValidations.clearNumberFormatValue($input.val()));break}}}if(input.id!="input-calle"){$input.val(cleanEmptySpaces(input.value))}}}function evaluateInputs(validations,input,isValid,errorMessageAux,isFocused,event){var inputIsValid=true;var validValue=isValid;var errMsg=errorMessageAux;if(validations.length>0){for(var i in validations){var selectorValues=selectorErrorInputs(input,validations[i],inputIsValid,isFocused,errMsg,event);inputIsValid=selectorValues.inputIsValid;errMsg=selectorValues.errorMessageAux;if(!inputIsValid){validValue=false;break}}}return{isValid:validValue,errorMessageAux:errMsg}}function notEmptyValidation(input,isFocused,errorMessageAux,isValid){var $input=$(input);var validValue=isValid;var errMsg=errorMessageAux;if(input.hasAttribute("required")){var isNotEmpty=SolicitudCreditoValidations.validationNotEmpty($input.val());if(!isNotEmpty&&!isFocused){errMsg=SolicitudCreditoValidations.getErrorMessageByInput(input,"required");SolicitudCreditoValidations.setInputError(input,errMsg);if(input.id=="birth_day"||input.id=="birth_month"||input.id=="birth_year"){}else{pageNameTagsError(errMsg,input)}}validValue=isNotEmpty}return{isValid:validValue,errorMessageAux:errMsg}}function setAllInputSuccess(isValid,input,isFocused){var $input=$(input);if(isValid){if($input.attr("type")=="radio"){var $radioGroupParent=$input.parents(".radio-group");if($radioGroupParent.length<=0){$radioGroupParent=$input.parent().parent().parent()}SolicitudCreditoValidations.clearInputStatus($radioGroupParent,$radioGroupParent);var inputName=$input.attr("name");var $radioInputs=$('input[type="radio"][name="'+inputName+'"]');for(var j=0;j<$radioInputs.length;j++){SolicitudCreditoValidations.setInputSuccess($radioInputs[j])}}else{if(input.value!=""){SolicitudCreditoValidations.setInputSuccess(input)}else{SolicitudCreditoValidations.clearInputStatus(input)}}}else{if(isFocused&&$input.hasClass("success")){SolicitudCreditoValidations.clearInputStatus(input)}}}function extraValidations(input,isFocused,isValid,errorMessageAux){if(isValid){var dataMatchTrim=cleanEmptySpaces(input.getAttribute("data-matchinput"));if(input.hasAttribute("data-matchinput")&&dataMatchTrim!=""){var matched=matchInputValidation(input,isFocused,isValid,errorMessageAux);return{isValid:matched,}}}return{isValid:isValid,}}function matchInputValidation(input,isFocused,isValid,errorMessageAux){var $input=$(input);var validValue=isValid;var errMsg=errorMessageAux;var $matchInputElement=$("#"+input.getAttribute("data-matchinput"));if($matchInputElement.length>0){if($matchInputElement.val()!=$input.val()){if(!isFocused){errMsg=SolicitudCreditoValidations.getErrorMessageByInput(input,"matchinput");SolicitudCreditoValidations.setInputError(input,errMsg);pageNameTagsError(errMsg,input)}validValue&=false}}return validValue}function extraValidationsNumExt(input,isFocused,isValid,errorMessageAux){if(isValid){var dataMatchTrim=cleanEmptySpaces(input.getAttribute("data-matchinputExt"));if(input.hasAttribute("data-matchinputExt")&&dataMatchTrim!=""){var matched=matchInputValidationNumExt(input,isFocused,isValid,errorMessageAux);return{isValid:matched,}}}return{isValid:isValid,}}function matchInputValidationNumExt(input,isFocused,isValid,errorMessageAux){var $input=$(input);var validValue=isValid;var errMsg=errorMessageAux;var numExtReg=/(?=[0-9])[A-Za-z0-9]{1,6}/g;if(numExtReg.test($input.val())==false){if(!isFocused){errMsg=SolicitudCreditoValidations.getErrorMessageByInput(input,"NumExtValid");SolicitudCreditoValidations.setInputError(input,errMsg)}validValue&=false}return validValue}function selectorErrorInputs(input,validation,inputIsValid,isFocused,errorMessageAux,event){var $input=$(input);var errMsg=errorMessageAux;var validValue=inputIsValid;switch(validation){case"email":validValue=SolicitudCreditoValidations.validateEmail($input.val());if(conditionalAndCompressor(!validValue,!isFocused)){errMsg=SolicitudCreditoValidations.getErrorMessageByInput(input,"email");SolicitudCreditoValidations.setInputError(input,errMsg);if(event=="blur"){pageNameTagsError(errMsg,input)}}break;case"streets":validValue=SolicitudCreditoValidations.validateStreets($input.val());if(conditionalAndCompressor(!validValue,!isFocused)){errMsg=SolicitudCreditoValidations.getErrorMessageByInput(input,"streets");SolicitudCreditoValidations.setInputError(input,errMsg)}break;case"minlength":validValue=SolicitudCreditoValidations.minLengthValidation(input);if(conditionalAndCompressor(!validValue,!isFocused)){if(input.id=="input-entrecalle-2"){$input.removeClass("no-error-message");$input.parent().addClass("entrecallesW")}if(input.id=="input-entrecalle-1"){$input.parent().addClass("entrecallesW")}errMsg=SolicitudCreditoValidations.getErrorMessageByInput(input,"minlength");SolicitudCreditoValidations.setInputError(input,errMsg.replace("???",input.getAttribute("minlength")));if(event=="blur"){pageNameTagsError(errMsg.replace("???",input.getAttribute("minlength")),input)}}break;case"minlengthtel":validValue=SolicitudCreditoValidations.minLengthValidation(input);if(conditionalAndCompressor(!validValue,!isFocused)){errMsg=SolicitudCreditoValidations.getErrorMessageByInput(input,"minlengthtel");SolicitudCreditoValidations.setInputError(input,errMsg);if(event=="blur"){pageNameTagsError(errMsg,input)}}break;case"minlengthtelref":validValue=SolicitudCreditoValidations.minLengthValidation(input);if(conditionalAndCompressor(!validValue,!isFocused)){errMsg=SolicitudCreditoValidations.getErrorMessageByInput(input,"minlengthtelref");SolicitudCreditoValidations.setInputError(input,errMsg);if(event=="blur"){pageNameTagsError(errMsg,input)}}break;case"minvalue":validValue=SolicitudCreditoValidations.minValueValidation(input);if(conditionalAndCompressor(!validValue,!isFocused)){errMsg=SolicitudCreditoValidations.getErrorMessageByInput(input,"minvalue");SolicitudCreditoValidations.setInputError(input,errMsg.replace("???",input.getAttribute("data-minvalue")));if(event=="blur"){pageNameTagsError(errMsg.replace("???",input.getAttribute("data-minvalue")),input)}}break;case"maxvalue":validValue=SolicitudCreditoValidations.maxValueValidation(input);if(!validValue){input.value=cleanEmptySpaces(input.getAttribute("data-maxvalue"));validValue=true}break;case"rfc":validValue=SolicitudCreditoValidations.validRFC($input.val());if(conditionalAndCompressor(!validValue,!isFocused)){errMsg=SolicitudCreditoValidations.getErrorMessageByInput(input,"rfc");SolicitudCreditoValidations.setInputError(input,errMsg)}break;case"required-radio":validValue=SolicitudCreditoValidations.validationRadioRequired(input);if(!validValue){errMsg=SolicitudCreditoValidations.getErrorMessageByInput(input,"requiredRadio");SolicitudCreditoValidations.setInputError(input,errMsg)}break;case"calle-valida":validValue=SolicitudCreditoValidations.validCalle(input);break;case"name-valid":validValue=validarNombres(input,inputIsValid);if(conditionalAndCompressor(!validValue,!isFocused)){errMsg=SolicitudCreditoValidations.getErrorMessageByInput(input,"nameValidation");SolicitudCreditoValidations.setInputError(input,errMsg);if(event=="blur"){pageNameTagsError(errMsg,input)}}break;case"lastname-valid":validValue=validarNombres(input,inputIsValid);if(conditionalAndCompressor(!validValue,!isFocused)){errMsg=SolicitudCreditoValidations.getErrorMessageByInput(input,"lastnameValidation");SolicitudCreditoValidations.setInputError(input,errMsg);if(event=="blur"){pageNameTagsError(errMsg,input)}}break;case"telref":validValue=SolicitudCreditoValidations.validarTelRef(input);if(!validValue){errMsg=SolicitudCreditoValidations.getErrorMessageByInput(input,"telRefDiffTel");SolicitudCreditoValidations.setInputError(input,errMsg)}break}return{inputIsValid:validValue,errorMessageAux:errMsg}}function validarNombres(input,inputIsValid){var inputText=$(input).val();if(inputText.length==2){const vocales=contarVocales(inputText);return(vocales==1)}else{return inputIsValid}}function conditionalAndCompressor(arg,arg2){return arg&&arg2}function iteratorCompressor(arr,action){for(var i in arr){action(arr[i])}}function handlePhasePending(phase,code,message){switch(phase){case 1:if(code=="SUCCESS"){linkRedirect(window.urlDatosCrediticios)}break;case 2:if(code=="AUTENTICADO"||code=="SUCCESS"||code=="SUCCESS_FAILED"||code=="FAILED_SIC"){Loading.loadingFinish();linkRedirect(window.urlDatosAdicionales)}else{if(code=="NO_AUTENTICADO"){linkRedirect(window.tpNoAutenticado)}else{$(".nip-generic-error").html(sanitisingValue(code)+"</br> Ocurrió un error.").show()}}break;case 3:var statusToProducto=["SUCCESS","APROBADO","ORDENSUPERVICION"];if(statusToProducto.indexOf(code)>-1){localStorage.solicitud_credito_parametrico_resultado=code;linkRedirect(window.urlProductos)}else{if(typeof responsesParametricoUrls[code]!="undefined"){linkRedirect(responsesParametricoUrls[code])}else{linkRedirect(window.tpGenericError)}}break;default:$(".nip-generic-error").html(sanitisingValue(code)+"</br> Ocurrió un error.").show();break}}function handlePhaseCAT(phase,code,data){switch(phase){case 1:if(code=="SUCCESS"){linkRedirect(window.urlDatosCrediticios)}else{if(response.code=="SINPRODUCTOS"||response.code=="FAILED_PRODUCTOS"){SolicitudCreditoValidations.exitCallbackFlag=0;linkRedirect(window.tpSinProducto)}}break;case 2:if(code=="AUTENTICADO"||code=="SUCCESS"||code=="SUCCESS_FAILED"||code=="FAILED_SIC"){if(data!=null&&data[0].autentico_buro==1){Loading.loadingFinish();linkRedirect(window.urlDatosAdicionales)}else{codigoVerificacionAjax(window.urlNip)}}else{if(code=="NO_AUTENTICADO"){linkRedirect(window.tpNoAutenticado)}else{$(".generic-error-content").html(sanitisingValue(code)+"</br> Ocurrió un error.").show()}}break;case 3:if(data!=null&&data[0].autentico_buro==0){linkRedirect(window.urlDatosCrediticios)}else{var statusToProducto=["SUCCESS","APROBADO","ORDENSUPERVICION"];if(statusToProducto.indexOf(code)>-1){localStorage.solicitud_credito_parametrico_resultado=code;linkRedirect(window.urlProductos)}else{if(typeof responsesParametricoUrls[code]!="undefined"){linkRedirect(responsesParametricoUrls[code])}else{$(".generic-error-content").html(sanitisingValue(code)+"</br> Ocurrió un error.").show()}}}break;default:$(".generic-error-content").html(sanitisingValue(code)+"</br> Ocurrió un error.").show();break}}function selectProduct(numProduct){switch(numProduct){case"0001":case"0002":validarParametricoAjax();break;case"0003":var parametricoCallbacks={callback:function(respuesta){var statusToProducto=["SUCCESS","APROBADO","ORDENSUPERVICION"];if(statusToProducto.indexOf(respuesta.code)>-1){localStorage.solicitud_credito_parametrico_resultado=respuesta.code;SolicitudCreditoValidations.exitCallbackFlag=0;linkRedirect(window.urlProductos)}else{SolicitudCreditoValidations.exitCallbackFlag=0;if(typeof responsesParametricoUrls[response.code]!="undefined"){linkRedirect(responsesParametricoUrls[response.code])}else{linkRedirect(window.tpGenericError)}}}};validarParametricoAjax(parametricoCallbacks);break;default:redirectError();break}}function processResultPresolicitud(result,saveSetting){if(result&&(result.code=="SUCCESS"||result.code=="SUCCESS_FAILED"||result.code=="FAILED_COTEL"||result.code=="FAILED_PRODUCTOS")){if(conditionalAndCompressor(result.data,result.data[0])){filtroLocalStorage(result.data[0]);SolicitudCreditoValidations.exitCallbackFlag=0;if(typeof saveSetting.callback=="function"){saveSetting.callback.call(this,result)}else{Loading.loadingFinish()}}else{redirectError()}}else{if(result&&result.code=="FAILED_EMPLEADO"){linkRedirect(window.tpErrorEmpleadoGrupoCoppel)}else{if(typeof saveSetting.errorCallback=="function"){saveSetting.errorCallback.call(this,result)}else{redirectError()}}}}function processDataNewValues(values){var newValues=values;var CLEAR_INVALID_CHARACTER=["'",'"',">","<","&","'"];var FORCE_MAYUS_KEYS=["nom_cliente","nom_nombreDosCliente","nom_primerApellido","nom_segundoApellido","nom_nombrereferencia","nom_apellidoreferencia","nom_nombrereferencia","nom_apellidoreferencia","nom_segundonombrereferencia","nom_segundoapellidoreferencia"];var FORCE_MINUS_KEYS=["desc_email"];var QUITAR_ACENTOS=["nom_cliente","nom_nombreDosCliente","nom_primerApellido","nom_segundoApellido"];for(var i in newValues){if(typeof newValues[i]=="undefined"||newValues[i]==null||newValues[i]==""||cleanEmptySpaces(newValues[i]+"")==""){delete newValues[i];continue}if(QUITAR_ACENTOS.indexOf(i)>-1){newValues[i]=omitirAcentos(newValues[i])}if(FORCE_MAYUS_KEYS.indexOf(i)>-1){newValues[i]=newValues[i].toUpperCase()}else{if(FORCE_MINUS_KEYS.indexOf(i)>-1){newValues[i]=newValues[i].toLowerCase()}}for(var j in CLEAR_INVALID_CHARACTER){newValues[i]+="";newValues[i]=newValues[i].replace(CLEAR_INVALID_CHARACTER[j],"")}}return newValues}function processInvalidElements(element,isValid){var isFormValid=isValid;var inputsRadioWithName=document.querySelectorAll('input[type="radio"][name="'+element.getAttribute("name")+'"]');var isRadioValid=false;for(var j in inputsRadioWithName){if(inputsRadioWithName[j].checked){isRadioValid=true;break}}if(!isRadioValid){isFormValid=false}return isFormValid}function processDataOnExit(data){var CLEAR_INVALID_CHARACTER=["'",'"',">","<","&","'"];var dataNewValues=data;for(var i in dataNewValues){if(typeof dataNewValues[i]=="undefined"||dataNewValues[i]==null){dataNewValues[i]=""}for(var j in CLEAR_INVALID_CHARACTER){dataNewValues[i]+="";dataNewValues[i]=dataNewValues[i].replace(CLEAR_INVALID_CHARACTER[j],"")}}return dataNewValues}function processAllAnimatedItems(items){if(items.length>0){for(var j in items){if(typeof items[j]=="object"&&j!="prevObject"){items[j].classList.remove("animated")}}}}function processAllSlides(allSlides,currentSlideIndex){var slides=allSlides;var current=currentSlideIndex;for(var i=0;i<slides.length;i++){slides[i].classList.remove("out");if(Object.values(slides[i].classList).indexOf("active")>-1){current=i}}return{allSlides:slides,currentSlideIndex:current}}function validationCodeSuccessAjax(url,response){if(typeof url=="object"){if(typeof url.callback=="function"){url.callback.call(this,response)}else{Loading.loadingFinish()}}else{if(typeof url=="string"){Loading.loadingFinish();linkRedirect(url)}}}function sendMedicionDigital(result){if(result.medicion!=undefined){SolicitudCreditoTagManager.sendResult(result)}}function saveValuesLeads(saveSetting){var isCheckedTerms=assignValuesConditional($(".checkbox-terminos").is(":checked"),1,0);var dataNewValues={idu_folioleads:assignValues(localStorage.id_folioleads,"none"),psc_prefolioid:assignValues(localStorage.pre_folio,"0"),idu_presolicitud:"0",num_etapasolicitud:assignValues($("#num_etapa_solicitud").val(),""),num_status_avisoprivacidad:assignValuesConditional($(".checkbox-terminos").length>0,isCheckedTerms,""),desc_zonahoraria:getTimeZone(),utm_content:assignValues(localStorage.app_origen,"none"),desc_rfc:assignValues($("#rfc").val(),"")};if(conditionalAndCompressor(typeof saveSetting.isFirstSave!="undefined",saveSetting.isFirstSave)){localStorage.solicitud_credito="{}"}var oldValues=JSON.parse((localStorage.solicitud_credito||"{}"));processDataNewValues(dataNewValues);if(typeof saveSetting.isFirstSave=="undefined"||!saveSetting.isFirstSave){dataNewValues.idu_presolicitud=oldValues.idu_presolicitud}if(localStorage.solicitud_credito==null||localStorage.solicitud_credito=="{}"||!localStorage.solicitud_credito){filtroLocalStorage(dataNewValues)}var restUrl=window.restUrlSolicitudLeads;restUrl+=assignValuesConditional(restUrl.indexOf("?")>-1,"&","?")+"utm="+(urlParams.get("utm_content")!=null?urlParams.get("utm_content"):"");Loading.show();$.ajax({url:restUrl,type:"POST",headers:{AdQKFIkT:localStorage.getItem("AdQKFIkT"),UdAgwnvI:localStorage.getItem("UdAgwnvI"),captcha_token:$("#captchatoken").val()},contentType:"application/json",dataType:"json",data:JSON.stringify(dataNewValues),success:function(result){if(result.statusCode==="400"){linkRedirect(window.tpErrorAlCrearToken);return}saveNewAuthToken(result);processResultPresolicitud(result,saveSetting)},error:function(error){console.log(error);if(typeof saveSetting.errorCallback=="function"){saveSetting.errorCallback.call(null)}else{redirectError()}}})}$("#securebar-description").addClass("securebar-description");function pageNameTagsError(errMsgTag,inputTag){var inputPageName=document.getElementById("page_name");var rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;if(inputPageName!=null&&inputPageName.value&&inputPageName.value.replace(rtrim,"")!=""){var pageName=inputPageName.value.replace(rtrim,"");switch(pageName){case"datosgenerales":if(inputTag=="fnd5"){SolicitudCreditoTagManager.catchError(errMsgTag,"fnd5")}else{SolicitudCreditoTagManager.catchError(errMsgTag,idsInputsDatosGenerales(inputTag))}break;case"datoscrediticios":SolicitudCreditoTagManager.catchError(errMsgTag,idsInputsDatosCrediticios(inputTag));break;case"datosadicionales":SolicitudCreditoTagManager.catchError(errMsgTag,idsInputsDatosAdicionales(inputTag));break}}}function saveNewAuthToken(result){try{if(result.new_token){localStorage.setItem("AdQKFIkT",result.new_token);localStorage.setItem("UdAgwnvI",result.userId)}}catch(error){}}function removeStorageTimer(){localStorage.removeItem("timerNip");localStorage.removeItem("tpIntentos");localStorage.removeItem("timerAutoGestion");localStorage.removeItem("temporizadorIniciadoAutoG");localStorage.removeItem("temporizadorIniciado")}function setAuthTokenLocalStorage(){var restUrl=window.restUrlTokenAuth;restUrl+=assignValuesConditional(restUrl.indexOf("?")>-1,"&","?")+"utm="+(urlParams.get("utm_content")!=null?urlParams.get("utm_content"):"");$.ajax({url:restUrl,type:"POST",headers:{AdQKFIkT:localStorage.getItem("AdQKFIkT"),UdAgwnvI:localStorage.getItem("UdAgwnvI")},contentType:"application/xml",dataType:"json",data:"",success:function(result){try{if(result.statusCode===200){localStorage.setItem("AdQKFIkT",result.token);localStorage.setItem("UdAgwnvI",result.userId)}}catch(error){console.error(error)}}})};localStorage.pre_folio=Date.now();var SolicitudCreditoTagManager={orderInputFilled:1,tipoSolicitud:function(){var tipo="Coppel";if(isBancoppel){tipo="BanCoppel"}else{if(isUnificado){tipo="Unificado"}}return tipo},getParams:function(){var pre_folio=localStorage.pre_folio;var solicitud_credito_values=JSON.parse((localStorage.solicitud_credito||"{}"));return{pscPrefolioId:parseInt(pre_folio),pscPresolicitudId:solicitud_credito_values.idu_presolicitud||solicitud_credito_values.idu_cliente||"",pscResultadoId:solicitud_credito_values.pscResultadoId||"",pscCoppelResultadoId:solicitud_credito_values.folioSolicitudCoppel||"",pscBanCoppelResultadoId:solicitud_credito_values.folioSolicitudBancoppel||"",pscResultadoDescripcion:solicitud_credito_values.pscResultadoDescripcion||"",pscCoppelResultadoDescripcion:solicitud_credito_values.descripcionSolicitudCoppel||"",pscBancoppelCoppelResultadoDescripcion:solicitud_credito_values.descripcionSolicitudBancoppel||"",tarjetaSolicitar:solicitud_credito_values.tarjetaSolicitar||"",}},procesandoGeneral:function(params){if(!params){params=this.getParams()}this.datosPersonalesProcesando(params)},datosPersonales:function(params){if(!params){params=this.getParams()}dataLayer.push({page:"/presolicitud-credito-"+this.tipoSolicitud().toLocaleLowerCase()+"/datos-personales",title:"Presolicitud de crédito "+this.tipoSolicitud()+" - Datos personales",pscPrefolioId:params.pscPrefolioId,event:"pvPresolicitudCreditoUnificado"})},datosPersonalesInteraccion:function(_params){dataLayer.push({nd1:"Presolicitud crédito "+this.tipoSolicitud(),nd2:"Primera intención",nd3:"",nd4:"1",event:"clicGeneral"})},avisoPrivacidad:function(_params){dataLayer.push({nd1:"Presolicitud crédito "+this.tipoSolicitud(),nd2:"Aviso de privacidad crédito",nd3:"",nd4:"1",event:"clicGeneral"})},avisoPrivacidadVerMas:function(_params){dataLayer.push({nd1:"Presolicitud crédito "+this.tipoSolicitud(),nd2:"Aviso de privacidad crédito",nd3:"Ver más",nd4:"1",event:"clicGeneral"})},avisoPrivacidadEnlace:function(_params){dataLayer.push({nd1:"Presolicitud crédito "+this.tipoSolicitud(),nd2:"Aviso de privacidad crédito",nd3:"Enlace",nd4:"1",event:"clicGeneral"})},datosPersonalesContinuar:function(params){if(!params){params=this.getParams()}dataLayer.push({nd1:"Presolicitud crédito "+this.tipoSolicitud(),nd2:"Datos personales",nd3:"Continuar",nd4:"",pscPresolicitudId:params.pscPresolicitudId||"",pscCoppelResultadoId:params.pscCoppelResultadoId||"",pscBanCoppelResultadoId:params.pscBanCoppelResultadoId||"",pscCoppelResultadoDescripcion:params.pscCoppelResultadoDescripcion||"",pscBancoppelCoppelResultadoDescripcion:params.pscBancoppelCoppelResultadoDescripcion||"",event:"clicPSC"})},datosPersonalesLinkBanCoppel:function(_params){dataLayer.push({nd1:"Presolicitud crédito "+this.tipoSolicitud(),nd2:"Datos personales",nd3:"bancoppel.com",nd4:"1",event:"clicGeneral"})},datosPersonalesLinkCondusef:function(_params){dataLayer.push({nd1:"Presolicitud crédito "+this.tipoSolicitud(),nd2:"Datos personales",nd3:"condusef.gob.mx",nd4:"1",event:"clicGeneral"})},datosPersonalesLinkEmail:function(_params){dataLayer.push({nd1:"Presolicitud crédito "+this.tipoSolicitud(),nd2:"Datos personales",nd3:"une@bancoppel.com",nd4:"1",event:"clicGeneral"})},datosPersonalesProcesando:function(params){if(!params){params=this.getParams()}dataLayer.push({nd1:"Presolicitud crédito "+this.tipoSolicitud(),nd2:"Datos personales",nd3:"Procesando",nd4:"",pscPresolicitudId:params.pscPresolicitudId||"",pscCoppelResultadoId:params.pscCoppelResultadoId||"",pscBanCoppelResultadoId:params.pscBanCoppelResultadoId||"",pscCoppelResultadoDescripcion:params.pscCoppelResultadoDescripcion||"",pscBancoppelCoppelResultadoDescripcion:params.pscBancoppelCoppelResultadoDescripcion||"",event:"clicPSC"})},sendResult:function(params){var pre_folio=localStorage.pre_folio;var solicitud_credito_values=JSON.parse((localStorage.solicitud_credito||"{}"));var medicion=params.medicion;dataLayer.push({nd1:"Presolicitud crédito "+this.tipoSolicitud(),nd2:"Respuesta del servicio",nd3:"",nd4:"",errorIdCorreo:medicion.errorIdCorreo,errorMensajeCorreo:medicion.errorMensajeCorreo,salidaTipoCorreo:medicion.salidaTipoCorreo,errorIdTel:medicion.errorIdTel,salidaTipoTel:medicion.salidaTipoTel,errorMensajeTel:medicion.errorMensajeTel,errorIdObtieneProd:medicion.errorIdObtieneProd,errorMensajeObtieneProd:medicion.errorMensajeObtieneProd,salidaTipoObtieneProd:medicion.salidaTipoObtieneProd,errorIdClienteCoppel:medicion.errorIdClienteCoppel,errorMensajeClienteCoppel:medicion.errorMensajeClienteCoppel,salidaTipoClienteCoppel:medicion.salidaTipoClienteCoppel,errorIdConsultaSIC:medicion.errorIdConsultaSIC,errorMensajeConsultaSIC:medicion.errorMensajeConsultaSIC,salidaTipoConsultaSIC:medicion.salidaTipoConsultaSIC,estatusSolicitudBancoppel:medicion.estatusSolicitudBancoppel,descripcionBancoppel:medicion.descripcionBancoppel,estatusSolicitudCoppel:medicion.estatusSolicitudCoppel,descripcionCoppel:medicion.descripcionCoppel,salidaTipoAltaUnica:medicion.salidaTipoAltaUnica,pagePathMD:"/presolicitud-credito-"+this.tipoSolicitud().toLocaleLowerCase()+"/datos-personales",pscPrefolioId:parseInt(pre_folio),pscPresolicitudId:solicitud_credito_values.idu_presolicitud||solicitud_credito_values.idu_cliente||"",event:"respuestaServicio"})},catchSuccess:function(inputNameLabel,params){if(!params){params=this.getParams()}dataLayer.push({nd1:"Presolicitud crédito "+this.tipoSolicitud(),nd2:"Datos personales",nd3:"Llenado Input: "+inputNameLabel+" - "+(this.orderInputFilled<10?"0"+this.orderInputFilled:this.orderInputFilled),nd4:"",pscPrefolioId:params.pscPrefolioId,pscPresolicitudId:params.pscPresolicitudId||"NA",event:"inputLlenado"});this.orderInputFilled++},catchError:function(msgError,idInput,params){if(!params){params=this.getParams()}dataLayer.push({nd1:"Presolicitud crédito "+this.tipoSolicitud(),nd2:"Datos generales",nd3:"Error en inputs: "+idInput+" - "+msgError,nd4:"",pscPrefolioId:params.pscPrefolioId||"",pscPresolicitudId:params.pscPresolicitudId||"",event:"sdcErrorInputGeneral"})}};var inputPageName=document.getElementById("page_name");var rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;console.log("current page: "+inputPageName.value.replace(rtrim,""));SolicitudCreditoTagManager.datosPersonales();function idsInputsDatosGenerales(input){var $input=$(input);var idInputs;switch(input.id){case"name":idInputs="pn1";break;case"secondname":idInputs="sn2";break;case"lastname":idInputs="pa3";break;case"middlename":idInputs="sa4";break;case"email":idInputs="ce9";break;case"phone":idInputs="tc10";break;case"phone_confirm":idInputs="ctc11";break}return idInputs};